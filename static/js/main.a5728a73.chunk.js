(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(3),a=n(5),c=n(281),i=n(1),o=n(129),l=n(164),s=n(0),u=function(e){var t=e.collections,n=e.structureCardProps,u=e.tableClass,d=e.renderTopForm,b=e.setSelected,j=e.selected,m=e.setFiltered,f=e.initialMode,p=void 0===f?"table":f,O=i.useState("small"),h=Object(a.a)(O,2),v=h[0],_=h[1],x=i.useState(p),g=Object(a.a)(x,2),y=g[0],E=g[1],N=i.useState(!1),C=Object(a.a)(N,2),S=C[0],w=C[1],M=i.useState(0),P=Object(a.a)(M,2),k=P[0],I=P[1],T="large"===v?"12rem":"medium"===v?"9em":"6em";return Object(s.jsxs)("div",{className:"d-flex flex-column",style:{height:"100%"},children:[Object(s.jsxs)("form",{className:"row mb-2 mt-2",children:[Object(s.jsx)("div",{className:"col flex-row d-flex",children:d}),Object(s.jsxs)("div",{className:"col d-flex justify-content-end",children:[Object(s.jsx)("button",{type:"button",title:"Force update ranking",className:"btn btn-sm btn-light ms-2 me-2",onClick:function(){return I((function(e){return e+1}))},children:Object(s.jsx)("i",{className:"fas fa-fw fa-sync-alt"})}),S?null:Object(s.jsx)("button",{type:"button",title:"Open as new window",className:"btn btn-sm btn-light ms-2 me-2",onClick:function(){return w(!0)},children:Object(s.jsx)("i",{className:"fas fa-fw fa-external-link-square-alt"})}),Object(s.jsxs)("div",{className:"btn-group btn-group-sm ms-2 me-2",role:"group",children:[Object(s.jsx)("button",{type:"button",className:"btn btn-light ".concat("table"===y?"active":""),onClick:function(){return E("table")},children:Object(s.jsx)("i",{className:"fas fa-fw fa-table"})}),Object(s.jsx)("button",{type:"button",className:"btn btn-light ".concat("grid"===y?"active":""),onClick:function(){return E("grid")},children:Object(s.jsx)("i",{className:"fas fa-fw fa-th"})})]}),Object(s.jsxs)("div",{className:"btn-group btn-group-sm ms-2",role:"group",children:[Object(s.jsx)("button",{type:"button",className:"btn btn-light ".concat("large"===v?"active":""),disabled:"grid"!==y,onClick:function(){return _("large")},children:Object(s.jsx)("i",{className:"fas fa-fw fa-grip-vertical"})}),Object(s.jsx)("button",{type:"button",className:"btn btn-light ".concat("medium"===v?"active":""),disabled:"grid"!==y,onClick:function(){return _("medium")},children:Object(s.jsx)("i",{className:"fas fa-fw fa-th"})}),Object(s.jsxs)("button",{type:"button",className:"btn btn-light ".concat("small"===v?"active":""),disabled:"grid"!==y,onClick:function(){return _("small")},children:[Object(s.jsx)("i",{className:"fas fa-fw fa-grip-vertical",style:{marginRight:"0.15em"}}),Object(s.jsx)("i",{className:"fas fa-fw fa-grip-vertical"})]})]})]})]}),Object(s.jsx)(o.a,{collections:t,setSelected:b,selected:j,setFiltered:m,className:"lineup-wrapper ".concat("table"!==y?"d-none":""," ").concat(u||""),onSelectionSet:function(e,t){var n,r,a=null===t||void 0===t?void 0:t[0].find((function(e){return e instanceof c.b}));(0===(null===(n=t[0])||void 0===n?void 0:n.getSortCriteria().length)||(null===a||void 0===a||null===(r=a.isSortedByMe())||void 0===r?void 0:r.asc))&&(null===a||void 0===a||a.sortByMe(!0),null===a||void 0===a||a.sortByMe(!1))}},k),"grid"===y?Object(s.jsx)("div",{style:{display:"grid"!==y?"none":"grid",gridTemplateColumns:"repeat(auto-fill, minmax(".concat(T,", 1fr))"),gridAutoRows:"auto",gridGap:"1rem"},children:t.map((function(e){return e.data})).flat().map((function(e,t,a){return Object(s.jsx)(l.a,Object(r.a)({structure:e,structures:t>0?[e,a[t-1]]:void 0},(null===n||void 0===n?void 0:n(e,t))||{}),t)}))}):null]})},d=i.memo(u)},129:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(26),a=n.n(r),c=n(37),i=n(5),o=n(28),l=n(3),s=n(10),u=n(1),d=n(153),b=n(284),j=n(340),m=n(4),f=n(39),p=n(339),O=n(285),h=n(160),v=n.n(h),_=n(44),x=n(161),g=n(163),y=n(34),E=n(106),N=n.n(E),C=n(143),S=n.n(C),w=n(0),M=function(){var e=Object(d.b)();return e.supportTypes(),e.allColumns(),e},P=function(e){var t=e.collections,n=e.getRankingBuilders,r=void 0===n?M:n,d=e.adjustRankings,h=e.setSelected,E=e.align,C=e.selected,P=e.setFiltered,k=e.onSelectionSet,I=Object(s.a)(e,["collections","getRankingBuilders","adjustRankings","setSelected","align","selected","setFiltered","onSelectionSet"]),T=u.useRef(null),D=u.useRef(null),A=u.useRef(null),B=u.useRef(null),R=u.useRef(!1),L=Object(_.c)(h),F=Object(_.c)(P),U=Object(_.c)(k),W=u.useMemo((function(){return t.reduce((function(e,t){return t.data.forEach((function(n){return e.push(Object(l.a)(Object(l.a)({},n),{},{_dataset:t.name,_particle:n}))})),e}),[])}),[t]);return u.useEffect((function(){var e;null===(e=D.current)||void 0===e||e.destroy();var t=36,n=r(),s=Object(b.a)(W).animated(!1);S()(n).forEach((function(e){return s.ranking(e)})),s.aggregationStrategy("group+item+top").propagateAggregationState(!0).registerColumnType("structureImage",g.a).registerRenderer("structureImage",new x.a).livePreviews({filter:!1}).sidePanel(!0,!0).dynamicHeight((function(){return{defaultHeight:18,height:function(){return t},padding:function(){return 0}}})),s.deriveColumns("_dataset"),s.column(Object(l.a)(Object(l.a)({},Object(j.a)("structure").label("Structure").renderer("structureImage","structureImage").width(3*t).build([])),{},{type:"structureImage"}));var u=W.map((function(e){var t=e.properties;return void 0===t?{}:t})),h=u.reduce((function(e,t){return!e||Object.keys(e).length<Object.keys(t).length?t:e}),null)||{},_=Object.keys(h).filter((function(e){return Object.getOwnPropertyDescriptor(h,e).get})),E=(Object.keys(h).filter((function(e){return!_.includes(e)})),Object(b.a)([h].concat(Object(o.a)(u))).deriveColumns());E.columns.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{column:"properties.".concat(e.column)})})).forEach((function(e){return s.column(e)})),s.columns.forEach((function(e){"numbers"===e.type&&(e.renderer="histogram",e.groupRenderer="histogram"),"number"===e.type&&(e.groupRenderer="histogram")}));var C=s.buildTaggle(T.current),w=C.data.find((function(e){return"structureImage"===e.getRenderer()}));w||console.error("Column with image renderer not found. Autoresizing disabled.");var M=v()((function(e,n){t=Math.min(Math.max(18,(n-0)/3),150),C.update()}),500),P=v()((function(e,t){var n="string"===typeof(null===t||void 0===t?void 0:t.filter)?null===t||void 0===t?void 0:t.filter:null;w&&n&&Object(y.j)(W.map((function(e){return e.structure})),n).then((function(e){var t=Object.entries(e.counts).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1]>0})).map((function(e){var t=Object(i.a)(e,2),n=t[0];t[1];return n}));w.setFilter({filter:n,valid:new Set(t),filterMissing:!0})})).catch((function(e){console.error(e),w.setFilter(null)}))}),1e3);null===w||void 0===w||w.on(m.b.EVENT_WIDTH_CHANGED,M),null===w||void 0===w||w.on(f.c.EVENT_FILTER_CHANGED,P);var k=function(e){return e.reduce((function(e,t){return e[t._dataset]||(e[t._dataset]=[]),e[t._dataset].push(t._particle),e}),{})};C.on(p.a.EVENT_SELECTION_CHANGED,Object(c.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R.current){e.next=7;break}return e.t0=k,e.next=4,C.data.view(C.getSelection());case 4:e.t1=e.sent,n=(0,e.t0)(e.t1),null===(t=L.current)||void 0===t||t.call(L,0===Object.entries(n).length?null:n);case 7:case"end":return e.stop()}}),e)}))));var I=!1;return C.data.on(O.a.EVENT_ADD_COLUMN,(function(e,t){if(!I){var n=e.desc.label.toLowerCase();if(e.desc.lazy){var r;E.deriveColumns(n);var a=null===(r=E.columns.filter((function(e){return e.column===n&&!e.lazy})).map((function(e){return Object(l.a)(Object(l.a)({},e),{},{column:"properties.".concat(e.column)})})))||void 0===r?void 0:r[0];I=!0;var c=C.data.getFirstRanking().insertAfter(C.data.create(a),e);I=!1,null===c||void 0===c||c.markDirty("all"),C.update()}}})),C.data.on(O.a.EVENT_ORDER_CHANGED,function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.length!==W.length){e.next=4;break}null===F||void 0===F||null===(r=F.current)||void 0===r||r.call(F,null),e.next=21;break;case 4:if(N()(t.slice().sort(),n.slice().sort())){e.next=21;break}if(null!==F&&void 0!==F){e.next=9;break}e.next=21;break;case 9:if(null!==(c=F.current)&&void 0!==c){e.next=13;break}e.next=21;break;case 13:return e.t0=c,e.t1=F,e.t2=k,e.next=18,C.data.view(n);case 18:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.call.call(e.t0,e.t1,e.t4);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),D.current=C,A.current=C.data.getRankings(),null===d||void 0===d||d(D.current,A.current),B.current=W.reduce((function(e,t,n){return e.set(t._particle,n),e}),new Map),function(){var e;null===(e=D.current)||void 0===e||e.destroy()}}),[t,W,F,L,r,d]),u.useEffect((function(){var e;null===(e=D.current)||void 0===e||e.data.getRankings().forEach((function(e){var t=e.flatColumns.find((function(e){return e instanceof g.a}));null===t||void 0===t||t.setAlign(E||null)}))}),[E]),u.useEffect((function(){if(D.current&&A.current&&B.current){var e;if(R.current=!0,C){if(!N()(C,D.current.getSelection())){var t=Object.values(C).flat().map((function(e){return B.current.get(e)}));D.current.setSelection(t)}}else D.current.setSelection([]);null===(e=U.current)||void 0===e||e.call(U,D.current,A.current),R.current=!1}}),[C,U]),Object(w.jsx)("div",Object(l.a)(Object(l.a)({},I||{}),{},{ref:T,style:Object(l.a)(Object(l.a)({},(null===I||void 0===I?void 0:I.style)||{}),{},{flex:1,fontSize:"smaller"})}))}},161:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return j}));var r=n(130),a=n(131),c=n(22),i=n(20),o=n(34),l=n(163),s=n(63),u='<a target="_blank" rel="noopener" style="background-size: contain; background-position: center; background-repeat: no-repeat;"></a>';function d(e){return"data:image/svg+xml;base64,".concat(btoa(e))}function b(e){return"url('".concat(d(e),"')")}var j=function(){function e(){Object(r.a)(this,e),this.title="Chemical Structure"}return Object(a.a)(e,[{key:"canRender",value:function(e,t){return e instanceof l.a&&(t===c.a.CELL||t===c.a.GROUP)}},{key:"create",value:function(e){return{template:u,update:function(t,n){if(!Object(i.b)(t,e,n)){var r;if(null===(r=n.v.images)||void 0===r?void 0:r[0])return void(t.style.backgroundImage=b(n.v.images[0]));var a=e.getValue(n);return Object(s.c)(new Promise((function(e){return setTimeout((function(){return e(a)}),500)}))).then((function(n){var r;"symbol"!==typeof n&&(t.style.backgroundImage="url('".concat(Object(o.c)(a,null===(r=e.getFilter())||void 0===r?void 0:r.filter,e.getAlign()),"')"),t.title=a,t.href="https://pubchem.ncbi.nlm.nih.gov/#query=".concat(a))}))}}}}},{key:"createGroup",value:function(e,t){return{template:u,update:function(n,r){t.tasks.groupRows(e,r,"StructureImageRendererGroup",(function(t){return Object(s.c)(Object(o.f)(Array.from(t.map((function(t){return e.getLabel(t)}))))).then((function(e){n.style.backgroundImage=e?b(e):""}))}))}}}}]),e}()},163:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(130),a=n(131),c=n(180),i=n(207),o=n(39),l=n(4),s=n(226),u=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).structureFilter=null,e.align=null,e}return Object(a.a)(n,[{key:"filter",value:function(e){return!this.isFiltered()||this.structureFilter.valid.has(this.getLabel(e))}},{key:"isFiltered",value:function(){var e;return null!=this.structureFilter&&(null===(e=this.structureFilter.valid)||void 0===e?void 0:e.size)>0}},{key:"getFilter",value:function(){return this.structureFilter}},{key:"setFilter",value:function(e){Object(s.isEqual)(e,this.structureFilter)||this.fire([o.c.EVENT_FILTER_CHANGED,l.b.EVENT_DIRTY_VALUES,l.b.EVENT_DIRTY],this.structureFilter,this.structureFilter=e)}},{key:"getAlign",value:function(){return this.align}},{key:"setAlign",value:function(e){Object(s.isEqual)(e,this.align)||this.fire([l.b.EVENT_DIRTY_VALUES,l.b.EVENT_DIRTY],this.align=e)}}]),n}(o.c)},164:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),a=n(5),c=n(10),i=n(1),o=n(58),l=n(0),s=i.memo((function(e){var t,n=e.structure,s=e.structures,u=e.enableModeSwitch,d=void 0===u||u,b=e.showProperties,j=void 0===b||b,m=Object(c.a)(e,["structure","structures","enableModeSwitch","showProperties"]),f=i.useState(!0),p=Object(a.a)(f,2),O=p[0],h=p[1],v=d&&Boolean(s);return Object(l.jsxs)("div",Object(r.a)(Object(r.a)({},m),{},{className:"card structure-card ".concat((null===m||void 0===m?void 0:m.className)||""),children:[Object(l.jsx)(o.a,{role:v?"button":void 0,title:v?"Switch molecule view":void 0,onClick:v?function(){return h(!O)}:void 0,className:"card-img-top",structure:O||!v?n.structure:s.map((function(e){return e.structure})),image:O||!v?null===(t=n.images)||void 0===t?void 0:t[O?0:1]:void 0}),Object(l.jsxs)("div",{className:"card-body",style:{padding:"0.25rem"},children:[Object(l.jsx)("h5",{className:"card-title text-truncate",children:n.structure}),Object(l.jsx)("div",{className:"card-text",children:j?Object.entries((null===n||void 0===n?void 0:n.properties)||{}).map((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(l.jsxs)("div",{className:"text-truncate",title:"".concat(n," ").concat(null===r||void 0===r?void 0:r.toLocaleString()),children:[Object(l.jsx)("strong",{children:n})," ",null===r||void 0===r?void 0:r.toLocaleString()]})})):null})]})]}))}))},176:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(1);var r=n(329),a=n(0);function c(e){var t=e.children,n=void 0===t?null:t,c=e.loading,i=e.loadingText,o=e.fallback,l=void 0===o?null:o;return!c&&n?Object(a.jsx)(a.Fragment,{children:n}):Object(a.jsx)("div",{className:"d-flex align-items-center justify-content-center",style:{flexDirection:"column",flex:1,overflow:"auto"},children:c?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(r.a,{animation:"border",className:"mb-1"}),i]}):l})}},178:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),a=r.createContext([])},182:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(27),a=n(1),c=n(0);function i(e){var t,n=e.label,i=e.position,o=e.collapsed,l=e.setCollapsed,s=e.children,u=e.size,d="right"===i?"start":"end";a.useEffect((function(){window.dispatchEvent(new Event("resize"))}),[o]);var b=Object(c.jsxs)("button",{onClick:function(){l((function(e){return!e}))},style:{},className:"btn btn-sm btn-outline-primary",children:[Object(c.jsx)("i",{className:"fas fa-fw fa-long-arrow-alt-".concat(o?"right"===i?"up":"down":i)})," ",o?n:null]});return Object(c.jsxs)(c.Fragment,{children:[o?Object(c.jsx)("div",{children:Object(c.jsx)("div",{style:(t={position:"absolute",top:50},Object(r.a)(t,i,0),Object(r.a)(t,"whiteSpace","nowrap"),Object(r.a)(t,"transform","rotate(270deg) translate(".concat("right"===i?"0, -100%":"-100%, 0",")")),Object(r.a)(t,"transformOrigin","".concat(i," 0")),Object(r.a)(t,"zIndex",1e3),t),children:b})}):null,o?null:Object(c.jsx)("div",{className:"".concat(u," ").concat(o?"":"border-".concat(d)),style:{position:"relative",height:"100%",overflow:"auto"},children:Object(c.jsxs)("div",{className:"sticky-top",children:[b,s]})})]})}},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(26),a=n.n(r),c=n(3),i=n(37),o=n(5),l=(n(1),n(34)),s=n(53),u=n(58),d=n(44),b=n(0),j=function(e){var t=e.open,n=e.setCollection,r=e.structures,j=e.setStructures,m=e.loading,f=e.setLoading,p=Object(d.b)("interpolationNameInput","Interpolated"),O=Object(o.a)(p,3),h=O[0],v=O[1],_=O[2];return Object(b.jsxs)(s.a,{open:t,title:"Interpolate between Structures",loading:m,setLoading:f,onSubmit:Object(i.a)(a.a.mark((function e(){var t,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=null===r||void 0===r?void 0:r.filter(Boolean))&&t.length>0)){e.next=8;break}return f(!0),e.next=5,Object(l.k)(t,100);case 5:i=e.sent,n(Object(c.a)({name:h},i)),v("");case 8:f(!1);case 9:case"end":return e.stop()}}),e)}))),children:[_,Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"inpolationStructures",children:"Structures (newline separated)"}),Object(b.jsx)("textarea",{className:"form-control form-control-sm",id:"inpolationStructures",rows:3,onChange:function(e){return null===j||void 0===j?void 0:j(e.currentTarget.value.split("\n"))},value:(null===r||void 0===r?void 0:r.join("\n"))||""})]}),Object(b.jsx)("div",{className:"text-center",children:r&&r.length>0?r.map((function(e){return Object(b.jsx)(u.a,{structure:e,width:"70px",height:"70px"},e)})).reduce((function(e,t,n){return[e,Object(b.jsx)("i",{className:"fas  fa-fw fa-long-arrow-alt-end ms-2 me-2"},n),t]})):null}),Object(b.jsx)("div",{className:"text-end",children:Object(b.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:m,children:m?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"})," Loading..."]}):Object(b.jsx)(b.Fragment,{children:"Compute Interpolation"})})})]})}},194:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),a=n(1),c=n(169),i=n(149),o=n(0);function l(e){var t=e.open,n=e.setOpen,l=e.onSave,s=a.useState(""),u=Object(r.a)(s,2),d=u[0],b=u[1],j=a.useCallback((function(){null===n||void 0===n||n(!1)}),[n]),m=a.useCallback((function(){null===l||void 0===l||l(d||null)}),[l,d]);return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)(c.a,{show:t,onHide:j,size:"lg",children:[Object(o.jsx)(c.a.Header,{closeButton:!0,children:Object(o.jsx)(c.a.Title,{children:"Upload dataset"})}),Object(o.jsx)(c.a.Body,{children:Object(o.jsxs)("form",{children:[Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{htmlFor:"customFileInput",children:"Either upload a file"}),Object(o.jsx)("input",{type:"file",className:"form-control",id:"customFileInput",onChange:function(e){var t=Array.from(e.currentTarget.files||[]);1===t.length&&t[0].text().then((function(e){b(e)}))}})]}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{htmlFor:"customFileTextarea",children:"Or paste the content"}),Object(o.jsx)("textarea",{id:"customFileTextarea",className:"form-control",onChange:function(e){return b(e.currentTarget.value)},value:d.substr(0,1e3)})]})]})}),Object(o.jsxs)(c.a.Footer,{children:[Object(o.jsx)(i.a,{variant:"secondary",onClick:j,children:"Close"}),Object(o.jsx)(i.a,{variant:"primary",onClick:m,children:"Upload"})]})]})})}},261:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(28),_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_InterpolationPage__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(262),react_bootstrap__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(214),react_bootstrap__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(341),react_bootstrap__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(150),react_bootstrap__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(342),react_bootstrap__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(149),_interfaces__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(79),_EmbeddingPage__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(276),_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(54),_utils_constants__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(62),_utils_api__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(34),_components_FileUploadModal__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(194),_CollectionContext__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(178),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__);function App(){var _React$useState=react__WEBPACK_IMPORTED_MODULE_2__.useState(!1),_React$useState2=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_React$useState,2),importFileModalShow=_React$useState2[0],setImportFileModalShow=_React$useState2[1],_React$useState3=react__WEBPACK_IMPORTED_MODULE_2__.useState(_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.EMBEDDING),_React$useState4=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_React$useState3,2),activeTab=_React$useState4[0],setActiveTab=_React$useState4[1],_React$useState5=react__WEBPACK_IMPORTED_MODULE_2__.useState([]),_React$useState6=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_React$useState5,2),collections=_React$useState6[0],_setCollections=_React$useState6[1],_React$useState7=react__WEBPACK_IMPORTED_MODULE_2__.useState(null),_React$useState8=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_React$useState7,2),registry=_React$useState8[0],setRegistry=_React$useState8[1],_React$useState9=react__WEBPACK_IMPORTED_MODULE_2__.useState(["NC1CC1C(=O)c1ccc2ccccc2c1","O=C(CN1C(=O)CSc2ccc(S(=O)C3CC3)cc21)NCc1cccnc1"]),_React$useState10=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_React$useState9,2),interpolationStructures=_React$useState10[0],setInterpolationStructures=_React$useState10[1];react__WEBPACK_IMPORTED_MODULE_2__.useEffect((function(){Object(_utils_api__WEBPACK_IMPORTED_MODULE_13__.g)().then((function(e){return setRegistry(e)})).catch((function(e){console.error("Error initializing registry",e)}))}),[]);var setCollections=react__WEBPACK_IMPORTED_MODULE_2__.useCallback((function(collections){collections.forEach((function(collection){collection.data.forEach((function(e,t){e.index=t,e.collection=collection.name})),collection.data.forEach((function(p,i){function injectEval(p,object,key,func){Object(_utils__WEBPACK_IMPORTED_MODULE_11__.c)(object,key,(function(){try{return eval(func)}catch(_unused){return null}}))}function injectJaccard(e,t,n,r,a){var c,i,o=null===(c=p.nearest_neighbors)||void 0===c?void 0:c[n],l=null===(i=p.nearest_neighbors)||void 0===i?void 0:i[r];if(!o||!l)throw Error("Could not inject jaccard getter: ".concat(n," or ").concat(r," are undefined."));Object(_utils__WEBPACK_IMPORTED_MODULE_11__.c)(e,t,(function(){var e=o.knn_ind.slice(0,a),t=new Set(l.knn_ind.slice(0,a));return e.filter((function(e){return t.has(e)})).length/e.length}))}function injectNNDiff(e,t,n,r,a,c){var i,o=null===(i=p.nearest_neighbors)||void 0===i?void 0:i[n],l=p.properties[r];if(!o||"number"!==typeof l)throw Error("Could not inject nn_diff getter: ".concat(n," is undefined or value is not a number."));var s=o.knn_particles.slice(0,c).map((function(e){return e.properties[r]||0}));Object(_utils__WEBPACK_IMPORTED_MODULE_11__.c)(e,t,(function(){var e;return null===(e=_utils_constants__WEBPACK_IMPORTED_MODULE_12__.a[a])||void 0===e?void 0:e.call(_utils_constants__WEBPACK_IMPORTED_MODULE_12__.a,l,s)}))}function injectCluster(e,t,n){var r,a=null===(r=p.clusters)||void 0===r?void 0:r[n];if(!a)throw Error("Could not inject cluster getter: ".concat(n," is undefined."));Object(_utils__WEBPACK_IMPORTED_MODULE_11__.c)(e,t,(function(){return a.label}))}Object.keys(p.properties).filter((function(e){return e.toLowerCase().startsWith("jaccard_")||e.toLowerCase().startsWith("nn_diff_")})).forEach((function(e){return delete p.properties[e]})),Object.entries(p.nearest_neighbors||{}).forEach((function(e){var t=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(e,2),n=(t[0],t[1]);n.knn_particles=n.knn_ind.map((function(e){return collection.data[e]}))})),p.nearest_neighbors&&!p.nearest_neighbors[_utils_constants__WEBPACK_IMPORTED_MODULE_12__.d]&&(p.nearest_neighbors=new Proxy(p.nearest_neighbors,{get:function(e,t){if(t===_utils_constants__WEBPACK_IMPORTED_MODULE_12__.d)return!0;if("symbol"!==typeof t){if(t.startsWith("property=")&&!(t in e)){var n=t.split("="),r=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(n,2),a=(r[0],r[1]),c=p.properties[a];if("number"===typeof c){var i=new Map(collection.data.map((function(e){return[e,Math.abs(c-e.properties[a])]}))),o=collection.data.sort((function(e,t){return i.get(e)-i.get(t)})).slice(1,51);e[t]={distance_metric:"absolute_property_difference",knn_dist:o.map((function(e){return i.get(e)})),knn_ind:o.map((function(e){return e.index})),knn_particles:o}}else if("string"===typeof c){var l=collection.data.filter((function(e){return p!==e&&e.properties[a]===c}));e[t]={distance_metric:"string_equality",knn_dist:l.map((function(e){return 0})),knn_ind:l.map((function(e){return e.index})),knn_particles:l}}}return e[t]}}})),p.properties[_utils_constants__WEBPACK_IMPORTED_MODULE_12__.d]||(p.properties=new Proxy(p.properties,{get:function(e,t){if(t===_utils_constants__WEBPACK_IMPORTED_MODULE_12__.d)return!0;if("symbol"!==typeof t){try{if(t.startsWith("eval=")&&!(t in e)){var n=t.split("="),r=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(n,2),a=(r[0],r[1]);injectEval(p,e,t,a)}if(t.startsWith("jaccard=")&&!(t in e)){var c=t.split("="),i=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(c,4);i[0];injectJaccard(e,t,i[1],i[2],+i[3])}if(t.startsWith("nn_diff=")&&!(t in e)){var o=t.split("="),l=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(o,5);l[0];injectNNDiff(e,t,l[1],l[2],l[3],+l[4])}if(t.startsWith("cluster=")&&!(t in e)){var s=t.split("="),u=Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(s,2);u[0];injectCluster(e,t,u[1])}}catch(d){console.error("Error injecting ".concat(t," getter"),d)}return e[t]}}}))}))})),_setCollections(collections)}),[_setCollections]);react__WEBPACK_IMPORTED_MODULE_2__.useEffect((function(){__webpack_require__.e(4).then(__webpack_require__.t.bind(null,344,3)).then((function(e){setCollections(e.default)}))}),[setCollections]);var interpolationCollection=react__WEBPACK_IMPORTED_MODULE_2__.useMemo((function(){return collections.find((function(e){return"Interpolated"===e.name}))}),[collections]),setInterpolationCollection=react__WEBPACK_IMPORTED_MODULE_2__.useCallback((function(e){_setCollections((function(t){return[].concat(Object(_home_runner_work_ChEmbVis_ChEmbVis_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(t.filter((function(e){return"Interpolated"!==e.name}))),[e])}))}),[_setCollections]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_CollectionContext__WEBPACK_IMPORTED_MODULE_15__.a.Provider,{value:collections,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)("div",{className:"vh-100 d-flex flex-column",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_5__.a,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.a.Brand,{href:"#home",children:"ChEmbVis"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.a.Collapse,{id:"responsive-navbar-nav",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.a,{className:"me-auto",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.a,{className:"me-auto",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.a.Link,{href:"#",active:activeTab===_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.EMBEDDING,onSelect:function(){return setActiveTab(_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.EMBEDDING)},children:"Embedding"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.a.Link,{href:"#",active:activeTab===_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.INTERPOLATION,onSelect:function(){return setActiveTab(_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.INTERPOLATION)},children:"Interpolation"})]})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.a,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__.a,{onClick:function(){setImportFileModalShow(!0)},children:"Import"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__.a,{className:"ms-2",disabled:0===collections.length,onClick:function(){Object(_utils__WEBPACK_IMPORTED_MODULE_11__.b)(collections,"export")},children:"Export"})]})]})]})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_components_FileUploadModal__WEBPACK_IMPORTED_MODULE_14__.a,{open:importFileModalShow,setOpen:setImportFileModalShow,onSave:function(e){if(e)try{setCollections(JSON.parse(e)),setImportFileModalShow(!1)}catch(t){console.error("Error parsing imported file.")}}}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("div",{className:"container-fluid mt-2",style:{flex:1,overflow:"auto"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)("div",{className:"row",style:{height:"100%",overflow:"auto",position:"relative"},children:[activeTab===_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.EMBEDDING?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_EmbeddingPage__WEBPACK_IMPORTED_MODULE_10__.a,{registry:registry,collections:collections,setCollections:setCollections,interpolationStructures:interpolationStructures,setInterpolationStructures:setInterpolationStructures,setActiveTab:setActiveTab}):null,activeTab===_interfaces__WEBPACK_IMPORTED_MODULE_9__.b.INTERPOLATION?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_InterpolationPage__WEBPACK_IMPORTED_MODULE_3__.a,{collection:interpolationCollection,setCollection:setInterpolationCollection,structures:interpolationStructures,setStructures:function(e){return setInterpolationStructures(e)}}):null]})})]})})}__webpack_exports__.a=App},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(5),a=n(1),c=n.n(a),i=n(176),o=n(128),l=n(182),s=n(183),u=n(0);function d(e){var t=e.structures,n=e.setStructures,a=e.collection,d=e.setCollection,b=c.a.useState(!1),j=Object(r.a)(b,2),m=j[0],f=j[1],p=c.a.useState(!1),O=Object(r.a)(p,2),h=O[0],v=O[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(l.a,{label:"Options",position:"left",size:"col-md-2",collapsed:m,setCollapsed:f,children:Object(u.jsx)(s.a,{open:!0,setCollection:d,loading:h,setLoading:v,setStructures:n,structures:t})}),Object(u.jsx)("div",{style:{display:"flex",flex:1,flexDirection:"column",overflow:"auto",marginLeft:33},children:Object(u.jsx)(i.a,{loading:h,fallback:"Please select structures for interpolation",children:a&&a.data.length>0?Object(u.jsx)(o.a,{collections:[a],tableClass:"main-ranking",structureCardProps:function(e){return{className:e.scaffold?"border-primary":""}}}):null})})]})}},276:function(e,t,n){"use strict";n.d(t,"a",(function(){return Xe}));var r=n(27),a=n(3),c=n(5),i=n(28),o=n(1),l=n(176),s=n(79),u=n(128),d=n(182),b=n(26),j=n.n(b),m=n(37),f=n(169),p=n(149),O=n(164),h=n(58),v=n(193),_=n.n(v),x=n(34),g=n(269),y=n.n(g),E=n(270),N=n.n(E),C=y()(N.a),S={displaylogo:!1,responsive:!0,showLink:!1},w=n(44),M=n(378),P=n(371),k=n(194),I=n(0);function T(e){var t=e.loading,n=e.disabled,r=e.text,a=e.onUploadData,i=e.onUploadResult,l=o.useState(null),s=Object(c.a)(l,2),u=s[0],d=s[1];return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(k.a,{open:Boolean(u),setOpen:function(e){return d(null)},onSave:function(e){var t;(null===(t="result"===u?i:"data"===u?a:null)||void 0===t?void 0:t(e))&&d(null)}}),Object(I.jsxs)(M.a,{as:P.a,drop:"end",children:[Object(I.jsx)(p.a,{variant:"primary",type:"submit",disabled:t||n,children:t?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"})," Loading..."]}):r}),a||i?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(M.a.Toggle,{split:!0,variant:"primary",disabled:t}),Object(I.jsxs)(M.a.Menu,{children:[a?Object(I.jsx)(M.a.Item,{onClick:function(){d("data")},children:"Upload data"}):null,i?Object(I.jsx)(M.a.Item,{onClick:function(){d("result")},children:"Upload precomputed result"}):null]})]}):null]})]})}var D=n(53),A=n(271);function B(e){var t,n=e.open,r=e.initialSmiles,a=void 0===r?"":r,i=e.setOpen,l=e.onSave,s=o.useState(a),u=Object(c.a)(s,2),d=u[0],b=u[1],j=o.useState(!1),m=Object(c.a)(j,2),O=m[0],h=m[1],v=o.useRef(null),_=o.useCallback((function(){null===i||void 0===i||i(!1)}),[i]),x=o.useCallback((function(){null===l||void 0===l||l(d||null)}),[l,d]);return o.useEffect((function(){if(n){var e=setTimeout((function(){h(!0)}),200);return function(){return clearTimeout(e)}}h(!1)}),[n]),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(f.a,{show:n,onHide:_,size:"lg",children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsx)(f.a.Title,{children:"Draw molecule"})}),Object(I.jsxs)(f.a.Body,{children:[Object(I.jsx)("div",{ref:v}),O?Object(I.jsx)(A.a,{height:"600px",width:"".concat((null===(t=v.current)||void 0===t?void 0:t.getBoundingClientRect().width)||600,"px"),options:"star",src:"https://jsme-editor.github.io/dist/jsme/jsme.nocache.js",smiles:a||void 0,onChange:b}):null]}),Object(I.jsxs)(f.a.Footer,{children:[Object(I.jsx)(p.a,{variant:"secondary",onClick:_,children:"Close"}),Object(I.jsx)(p.a,{variant:"primary",onClick:x,children:"Save"})]})]})})}function R(e){var t=e.value,n=e.selection,r=e.setValue,a=o.useMemo((function(){var e;return null===(e=Object.values(n||{}).find((function(e){return e.length>0})))||void 0===e?void 0:e[0]}),[n]),i=o.useState(!1),l=Object(c.a)(i,2),s=l[0],u=l[1];return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(B,{open:s,setOpen:u,initialSmiles:t,onSave:function(e){e&&r(e),u(!1)}}),Object(I.jsx)("button",{className:"btn btn-outline-secondary",type:"button",title:"Use selected structure as input",disabled:!a,onClick:function(){return a?r(a.structure):void 0},children:Object(I.jsx)("i",{className:"fas fa-mouse-pointer"})}),Object(I.jsx)("button",{className:"btn btn-outline-secondary",type:"button",title:"Draw structure",onClick:function(){return u(!0)},children:Object(I.jsx)("i",{className:"fas fa-draw-polygon"})})]})}var L=n(370),F=n(228),U=(n(307),n(233)),W=n(330),K=[600,400];function z(e){var t=e.open,n=e.initialPoints,r=void 0===n?[]:n,a=e.setOpen,i=e.onSave,l=o.useState([]),s=Object(c.a)(l,2),u=s[0],d=s[1],b=o.useState(0),j=Object(c.a)(b,2),m=j[0],O=j[1],h=o.useState(1),v=Object(c.a)(h,2),_=v[0],x=v[1],g=o.useState(m),y=Object(c.a)(g,2),E=y[0],N=y[1],C=o.useState(_),S=Object(c.a)(C,2),w=S[0],M=S[1];o.useEffect((function(){N(m),M(_)}),[m,_]),o.useEffect((function(){d(r.map((function(e,t){var n=e.x,r=e.y;return{id:t.toString(),x:n,y:r}})));var e=Object(W.a)(r.map((function(e){return e.x}))),t=Object(c.a)(e,2),n=t[0],a=t[1];O(null!==n&&void 0!==n?n:0),x(null!==a&&void 0!==a?a:1)}),[r]);var P=o.useMemo((function(){return{x:Object(U.a)().domain([m,_]).range([0,K[0]-100]).clamp(!0),y:Object(U.a)().domain([0,1]).range([K[1]-100,0]).clamp(!0)}}),[m,_]),k=o.useCallback((function(){null===a||void 0===a||a(!1)}),[a]),T=o.useCallback((function(){null===i||void 0===i||i(u.map((function(e){return{x:e.x,y:e.y}})))}),[i,u]);return Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(f.a,{show:t,onHide:k,size:"lg",children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsx)(f.a.Title,{children:"Draw desirability"})}),Object(I.jsxs)(f.a.Body,{children:[Object(I.jsxs)("form",{className:"row mb-2",style:{alignItems:"baseline",flexFlow:"row",justifyContent:"center"},onSubmit:function(e){e.preventDefault(),e.stopPropagation(),O(E),x(w)},children:[Object(I.jsxs)("div",{className:"col mb-3 me-4",children:[Object(I.jsx)("label",{htmlFor:"curveMinInput",children:"Minimum"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm ms-2",id:"curveMinInput",value:E,onChange:function(e){return N(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"col mb-3 me-4",children:[Object(I.jsx)("label",{htmlFor:"curveMaxInput",children:"Maximum"}),Object(I.jsx)("input",{type:"number",className:"form-control  form-control-sm ms-2",id:"curveMaxInput",value:w,onChange:function(e){return M(e.currentTarget.valueAsNumber)}})]}),Object(I.jsx)("div",{className:"col",children:Object(I.jsx)("button",{type:"submit",className:"btn btn-sm btn-primary",children:"Apply"})})]}),Object(I.jsx)(F.CurveEditor,{points:u,setPoints:d,scales:P,viewBoxSize:K,curveType:F.DEFAULT_CURVE_TYPES.Linear})]}),Object(I.jsxs)(f.a.Footer,{children:[Object(I.jsx)(p.a,{variant:"secondary",onClick:k,children:"Close"}),Object(I.jsx)(p.a,{variant:"primary",onClick:T,children:"Save"})]})]})})}var V=function(e){var t=e.availableObjectives,n=e.addCollection,l=e.selection,s=e.loading,u=e.setLoading,d=Object(w.b)("msoNameInput","MSO"),b=Object(c.a)(d,3),f=b[0],p=b[1],O=b[2],h=o.useState(""),v=Object(c.a)(h,2),_=v[0],g=v[1],y=o.useState(50),E=Object(c.a)(y,2),N=E[0],C=E[1],S=o.useState(10),M=Object(c.a)(S,2),P=M[0],k=M[1],A=o.useState(5),B=Object(c.a)(A,2),F=B[0],U=B[1],W=o.useState(-.6),K=Object(c.a)(W,2),V=K[0],q=K[1],H=o.useState(.6),$=Object(c.a)(H,2),G=$[0],J=$[1],Y=o.useState(.9),X=Object(c.a)(Y,2),Q=X[0],Z=X[1],ee=o.useState(2),te=Object(c.a)(ee,2),ne=te[0],re=te[1],ae=o.useState(2),ce=Object(c.a)(ae,2),ie=ce[0],oe=ce[1],le=o.useState(2),se=Object(c.a)(le,2),ue=se[0],de=se[1],be=o.useState(),je=Object(c.a)(be,2),me=je[0],fe=je[1],pe=o.useState([]),Oe=Object(c.a)(pe,2),he=Oe[0],ve=Oe[1],_e=o.useState(null),xe=Object(c.a)(_e,2),ge=xe[0],ye=xe[1];return Object(I.jsxs)(D.a,{title:"Molecular Swarm Optimization",loading:s,setLoading:u,onSubmit:Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.l)({structure:_,iterations:P,num_swarms:F,num_part:N,v_min:V,v_max:G,inertia_weight:Q,phi1:ne,phi2:ie,phi3:ue,objectives:he});case 2:t=e.sent,n(Object(a.a)(Object(a.a)({},t),{},{name:f})),p("");case 5:case"end":return e.stop()}}),e)}))),children:[ge?Object(I.jsx)(z,{open:null!=ge,initialPoints:ge.desirability,setOpen:function(e){return e?null:ye(null)},onSave:function(e){ve(he.map((function(t){return t===ge?Object(a.a)(Object(a.a)({},t),{},{desirability:e}):t}))),ye(null)}}):null,O,t?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"msoObjectivesSelect",children:"Objectives"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsxs)("select",{className:"form-control",id:"msoObjectivesSelect",value:null===me||void 0===me?void 0:me.name,onChange:function(e){fe(t.find((function(t){return t.name===e.currentTarget.value})))},children:[Object(I.jsx)("option",{value:"",children:"Choose..."}),t.map((function(e){return Object(I.jsx)("option",{value:e.name,children:e.name},e.name)}))]}),Object(I.jsx)("input",{type:"number",className:"form-control-plaintext form-control-sm",required:!0,value:he.length,onChange:function(){return null},min:1,style:{flex:"0 0 1px"}}),Object(I.jsx)("button",{disabled:!me,className:"btn btn-outline-secondary",type:"button",onClick:function(){return ve([].concat(Object(i.a)(he),[me]))},children:"Add"})]}),Object(I.jsx)("small",{id:"msoObjectivesSelect",className:"form-text text-muted",children:"Objectives define the optimization goal of MSO"})]}),Object(I.jsx)("div",{className:"mb-3",style:{overflowX:"hidden"},children:he.map((function(e){return Object(I.jsxs)("details",{className:"mb-1",open:Boolean(e.additional_args),children:[Object(I.jsxs)("summary",{className:"text-truncate",children:[e.name," ",Object(I.jsxs)("div",{className:"btn-group btn-group-sm ms-2 me-2 float-end",role:"group",children:[Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Adjust desirability curve",onClick:function(){ye(e)},children:Object(I.jsx)("i",{className:"fas fa-fw fa-bezier-curve"})}),Object(I.jsx)("button",{type:"button",className:"btn btn-danger",title:"Delete objective",onClick:function(){ve(he.filter((function(t){return t!==e})))},children:Object(I.jsx)("i",{className:"fas fa-fw fa-times"})})]})]}),Object(I.jsx)("small",{title:e.description,className:"text-truncate",children:e.description}),Object(I.jsxs)("div",{className:"d-flex",title:"Relative weight of objective",children:[Object(I.jsx)("input",{type:"range",className:"form-range me-2",min:1,max:100,step:1,value:e.weight,onChange:function(t){ve(he.map((function(n){return n===e?Object(a.a)(Object(a.a)({},n),{},{weight:t.currentTarget.valueAsNumber}):n})))}}),e.weight,"%"]}),Object.entries(e.additional_args||{}).map((function(t){var n=Object(c.a)(t,2),i=n[0],o=n[1],s=function(t){return ve(he.map((function(n){return n===e?Object(a.a)(Object(a.a)({},n),{},{additional_args:Object(a.a)(Object(a.a)({},n.additional_args),{},Object(r.a)({},i,t))}):n})))};return Object(I.jsxs)("div",{className:"input-group input-group-sm",children:["query"===i?Object(I.jsx)(R,{value:o,selection:l,setValue:s}):null,Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",placeholder:i,value:o,required:!0,onChange:function(e){return s(e.currentTarget.value)}},i)]},i)})),Object(I.jsx)("hr",{})]},e.name)}))}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"startingStructureInput",children:"Starting structure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:_,selection:l,setValue:g}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"startingStructureInput","aria-describedby":"startingStructureInputHelp",required:!0,value:_,onChange:function(e){return g(e.currentTarget.value)}})]}),Object(I.jsx)("small",{id:"startingStructureInputHelp",className:"form-text text-muted"})]}),Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:"Advanced Settings"}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"nrOfSwarmsInput",children:"Swarms"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"nrOfSwarmsInput",value:F,required:!0,min:1,onChange:function(e){return U(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"nrOfParticlesInput",children:"Particles"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"nrOfParticlesInput",value:N,required:!0,min:1,onChange:function(e){return C(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"nrOfIterationsInput",children:"Iterations"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"nrOfIterationsInput",value:P,required:!0,min:1,onChange:function(e){return k(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"vMinInput",children:"Min Velocity"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"vMinInput",value:V,required:!0,step:.1,onChange:function(e){return q(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"vMaxInput",children:"Max Velocity"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"vMaxInput",value:G,required:!0,step:.1,onChange:function(e){return J(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"inertiaWeightInput",children:"Inertia Weight"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"inertiaWeightInput",value:Q,required:!0,step:.1,onChange:function(e){return Z(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"phi1Input",children:"Phi 1"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"phi1Input",value:ne,required:!0,step:.1,onChange:function(e){return re(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"phi2Input",children:"Phi 2"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"phi2Input",value:ie,required:!0,step:.1,onChange:function(e){return oe(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"phi3Input",children:"Phi 3"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"phi3Input",value:ue,required:!0,step:.1,onChange:function(e){return de(e.currentTarget.valueAsNumber)}})]})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:s,text:"Run MSO",onUploadResult:function(e){if(e)return n({data:JSON.parse(e),name:"MSO"}),!0}})})]}):Object(I.jsx)(L.a,{variant:"info",children:Object(I.jsx)("p",{children:"No objectives are available."})})]})},q=n(10),H=n(273),$=function(e){var t=e.addCollection,n=e.loading,r=e.setLoading,i=Object(w.b)("cdddNameInput",""),l=Object(c.a)(i,3),u=l[0],d=l[1],b=l[2],f=o.useState(""),p=Object(c.a)(f,2),O=p[0],h=p[1];return Object(I.jsxs)(D.a,{title:"Compute Embeddings",loading:n,setLoading:r,onSubmit:Object(m.a)(j.a.mark((function e(){var n,r,c,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],c={},i=Object(H.parse)(O,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,transformHeader:function(e){return["smiles","structure","structures"].includes(e.trim().toLocaleLowerCase())?"smiles":e.trim()},transform:function(e,t){return t.toString().startsWith("emb_")?JSON.parse(e):e}}),null===(n=i.meta.fields)||void 0===n?void 0:n.includes("smiles")){e.next=5;break}throw Error('No header named "smiles" found. Please include a header called "smiles" in the column of the structure.');case 5:return i.data.filter((function(e){return e.smiles})).forEach((function(e){var t=e.smiles,n=Object(q.a)(e,["smiles"]),a={};Object.keys(n).filter((function(e){return e.startsWith("emb_")})).forEach((function(e){a[e]=n[e],delete n[e]})),r.push({smiles:t,embeddings:a}),c[t]=n})),e.next=8,Object(x.b)({structures:r,include_embedding:!1});case 8:(o=e.sent).data=o.data.map((function(e){var t=c[e.original_structure];return t&&(e.properties=Object(a.a)(Object(a.a)({},e.properties||{}),t)),e})),t(Object(a.a)({name:u},o)),d("");case 12:case"end":return e.stop()}}),e)}))),children:[b,Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"cdddTextarea",children:"Structures to convert"}),Object(I.jsx)("textarea",{className:"form-control form-control-sm",id:"cdddTextarea",rows:3,onChange:function(e){return h(e.currentTarget.value)},value:O}),Object(I.jsx)("small",{id:"cdddTextareaHelp",className:"form-text text-muted",children:'Any CSV file format with a header "smiles" is valid. You can add additional properties as columns, which will be shown in the visualizations and ranking. Additionally, any column starting with "emb_" will be parsed as JSON (value has to be an array like "[1.2, 1.3, 1.5, ...]") and used as precomputed embedding.'})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:n,text:"Compute",onUploadData:function(e){return h(e||""),!0},onUploadResult:function(e){if(e)return t({data:JSON.parse(e),name:s.a}),!0}})})]})},G=function(e){var t=e.collections,n=e.setCollections,i=e.selection,l=e.loading,s=e.setLoading,u=o.useState(""),d=Object(c.a)(u,2),b=d[0],f=d[1],p=function(){var e=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map((function(e){var t=e.data;return Object(x.j)(t.map((function(e){return e.structure})),b)}))).then((function(e){n(t.map((function(t,n){return Object(a.a)(Object(a.a)({},t),{},{data:t.data.map((function(t){var c,i;return Object(a.a)(Object(a.a)({},t),{},{properties:Object(a.a)(Object(a.a)({},t.properties||{}),{},(i={},Object(r.a)(i,"Has ".concat(b),Boolean(e[n].validity[t.structure])),Object(r.a)(i,"Count ".concat(b),null!==(c=e[n].counts[t.structure])&&void 0!==c?c:0),i))})})),selection:null})})))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)(D.a,{title:"Substructure Matching",loading:l,setLoading:s,onSubmit:p,children:[Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"smartsStructureInput",children:"Substructure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:b,selection:i,setValue:f}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"smartsStructureInput","aria-describedby":"smartsStructureInput",value:b,onChange:function(e){return f(e.currentTarget.value)}})]}),Object(I.jsx)("small",{id:"smartsStructureInputHelp",className:"form-text text-muted",children:"Use a SMILES or SMARTS query"})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:l,disabled:!b,text:"Compute Substructure Matches"})})]})},J=function(e){var t=e.collections,n=e.setCollections,i=e.selection,l=e.loading,s=e.setLoading,u=o.useState(""),d=Object(c.a)(u,2),b=d[0],f=d[1],p=o.useState("ecfp4"),O=Object(c.a)(p,2),h=O[0],v=O[1];return Object(I.jsxs)(D.a,{title:"Tanimoto Similarity",loading:l,setLoading:s,onSubmit:function(){if("embeddings"!==h)return Promise.all(t.map(function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.abrupt("return",Object(x.i)(n.map((function(e){return e.structure})),b,h));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){n(t.map((function(t,n){return Object(a.a)(Object(a.a)({},t),{},{data:t.data.map((function(t){return Object(a.a)(Object(a.a)({},t),{},{properties:Object(a.a)(Object(a.a)({},t.properties||{}),{},Object(r.a)({},"".concat(h," Distance ").concat(b),e[n].tanimoto[t.structure]))})})),selection:null})})))}));n(t.map((function(e){var t,n,c=null===(t=Object.values(i||{}))||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0];if(!c||!c.embedding||0===Object.entries(c.embedding).length)throw Error("This type of similarity requires an active selection (with precomputed embeddings)");var o=Object.keys(c.embedding);return Object(a.a)(Object(a.a)({},e),{},{data:e.data.map((function(e){return Object(a.a)(Object(a.a)({},e),{},{properties:Object(a.a)(Object(a.a)({},e.properties||{}),o.reduce((function(t,n){var i,o;return Object(a.a)(Object(a.a)({},t),{},Object(r.a)({},"".concat(n," Distance ").concat(b),null===(i=e.embedding)||void 0===i||null===(o=i[n])||void 0===o?void 0:o.reduce((function(e,t,r){var a=c.embedding[n][r];return e-Math.pow(t-a,2)}),0)))}),{}))})})),selection:null})})))},children:[Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"similarityRefStructureInput",children:"Reference structure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:b,selection:i,setValue:f}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"similarityRefStructureInput","aria-describedby":"similarityRefStructureInput",value:b,onChange:function(e){return f(e.currentTarget.value)}})]})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"similarityFingerprintInput",children:"Fingerprint"}),Object(I.jsxs)("select",{className:"form-control form-control-sm",id:"similarityFingerprintInput",value:h,onChange:function(e){return v(e.currentTarget.value)},children:[Object(I.jsx)("option",{value:"ecfp2",children:"ECFP2 (Morgan Fingerprint)"}),Object(I.jsx)("option",{value:"ecfp4",children:"ECFP4 (Morgan Fingerprint)"}),Object(I.jsx)("option",{value:"cddd",children:"Descriptors from CDDD (ChEMBL only)"}),Object(I.jsx)("option",{value:"embeddings",children:"Embeddings"})]})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:l,disabled:!b,text:"Compute Similarity"})})]})},Y=n(274),X=n.n(Y),Q=n(373),Z=n(374),ee=n(230),te=n(106),ne=n.n(te),re=n(379),ae=n(277),ce=o.memo((function(e){e.gridOptions;var t=e.key,n=e.children,r=e.onClose,a=e.onSettings,c=e.renderInfo,i=e.enableMove,o=void 0===i||i;return Object(I.jsxs)(I.Fragment,{children:[o?Object(I.jsx)("i",{className:"fas fa-fw fa-arrows-alt react-grid-item-hidden react-grid-item-drag-handle",title:"Move",style:{position:"absolute",zIndex:1,top:3,left:5,cursor:"pointer"}}):null,c?Object(I.jsx)(re.a,{trigger:["hover","focus"],placement:"auto",overlay:Object(I.jsxs)(ae.a,{id:t,children:[Object(I.jsx)(ae.a.Header,{as:"h3",children:"Projection information"}),Object(I.jsx)(ae.a.Body,{children:c()})]}),children:Object(I.jsx)("i",{className:"fas fa-fw fa-info-circle react-grid-item-hidden",style:{position:"absolute",zIndex:1,top:3,left:30,cursor:"pointer"}})}):null,a?Object(I.jsx)("i",{className:"fas fa-fw fa-cog react-grid-item-hidden",title:"Change settings",onClick:a,style:{position:"absolute",zIndex:1,top:3,left:55,cursor:"pointer"}}):null,r?Object(I.jsx)("i",{className:"fas fa-fw fa-times react-grid-item-hidden",title:"Close",onClick:r,style:{position:"absolute",zIndex:1,top:3,left:80,cursor:"pointer"}}):null,n]})})),ie=n(229),oe=n.n(ie),le=Object(ie.WidthProvider)(oe.a),se=function(e){var t=e.children,n=o.useState(),r=Object(c.a)(n,2),l=r[0],s=r[1],u=o.useMemo((function(){return(!t||Array.isArray(t)?t.flat():[t]).filter((function(e){return null===e||void 0===e?void 0:e.key}))}),[t]);return o.useEffect((function(){var e=u.filter((function(e){return null!=(null===e||void 0===e?void 0:e.key)})),t=e.filter((function(e){return!(null===l||void 0===l?void 0:l.find((function(t){return t.i===e.key})))}));t.length>0&&s([].concat(Object(i.a)((null===l||void 0===l?void 0:l.filter((function(t){return e.find((function(e){return e.key===t.i}))})))||[]),Object(i.a)(t.map((function(e,t){var n;return Object(a.a)({i:e.key,h:15,w:6,x:t%2===0?0:6,y:1},(null===e||void 0===e||null===(n=e.props)||void 0===n?void 0:n.gridOptions)||{})})))))}),[u,l]),l?Object(I.jsx)(le,{draggableHandle:".react-grid-item-drag-handle",cols:12,rowHeight:10,className:"flex-fill",verticalCompact:!0,layout:l,compactType:"horizontal",onLayoutChange:function(e){window.dispatchEvent(new Event("resize")),s(e)},children:u.map((function(e){return Object(I.jsx)("div",{children:e},e.key)}))}):null},ue=n(62),de=o.memo((function(e){var t=e.collections,n=e.selection,l=e.setSelection,s=e.filterSelection,u=o.useState(null),d=Object(c.a)(u,2),b=d[0],j=d[1],m=o.useState([]),f=Object(c.a)(m,2),p=f[0],O=f[1],h=o.useState(null),v=Object(c.a)(h,2),_=v[0],x=v[1],g=o.useState(null),y=Object(c.a)(g,2),E=y[0],N=y[1],w=o.useMemo((function(){return t.filter((function(e){return!e.hidden}))}),[t]),M=o.useMemo((function(){return Array.from(new Set(w.map((function(e){var t;return Object.keys((null===(t=e.data[0])||void 0===t?void 0:t.properties)||{})})).flat()))}),[w]);return o.useEffect((function(){N(null)}),[w,p]),o.useEffect((function(){j((function(e){if(p.length<2)return null;var t=Object.values(s||{}).flat(),n=t.length>0?t:w.map((function(e){return e.data})).flat().slice(0,500),r={frames:[],layout:Object(a.a)(Object(a.a)({},(null===e||void 0===e?void 0:e.layout)||{}),{},{autosize:!0,colorway:ue.b,showlegend:!0}),data:[{type:"parcoords",line:Object(a.a)(Object(a.a)({showscale:!1},ue.c),{},{color:_?n.map((function(e){return e.properties[_.value]})):w.map((function(e,t){return Array(e.data.length).fill(t.toString())})).flat()}),dimensions:Object(i.a)(p.map((function(e){var t=e.value,r=e.order,a=n.map((function(e){return e.properties[t]})),c=Object(Q.a)(a),i=Object(Z.a)(a);if(null==c||null==i)return null;var o=[Math.min(0,c),i];return{range:"desc"===r?o:o.reverse(),constraintrange:null===E||void 0===E?void 0:E[t],values:a,label:t}})))}]};return console.log(r),r}))}),[w,s,p,E,_]),Object(I.jsxs)("div",{className:"d-flex flex-column flex-fill",children:[Object(I.jsx)("form",{children:Object(I.jsxs)("div",{className:"row",children:[Object(I.jsxs)("div",{className:"col-md-10 mb-3",children:[Object(I.jsx)("label",{htmlFor:"propertiesSelect",children:"Properties"}),Object(I.jsx)(ee.a,{menuPosition:"fixed",isMulti:!0,className:"mb-3",name:"propertiesSelect",value:p,onChange:function(e){O(e)},options:M.map((function(e){return{value:e,label:e,order:"desc"}})),openMenuOnClick:!1,closeMenuOnSelect:!1,formatOptionLabel:function(e,t){return"value"===t.context?Object(I.jsxs)("div",{className:"d-flex flex-row align-items-center",children:[Object(I.jsx)("span",{title:e.label,className:"text-truncate",style:{maxWidth:150},children:e.label}),Object(I.jsx)("i",{role:"button",title:"Change axis order",className:"fas fa-fw fa-sort-amount-".concat("asc"===e.order?"up-alt":"down"," ms-1 me-1 "),onClick:function(t){O(p.map((function(t){return t===e?Object(a.a)(Object(a.a)({},t),{},{order:"asc"===t.order?"desc":"asc"}):t})))}})]}):e.label}})]}),Object(I.jsxs)("div",{className:"col-md-2 mb-3",children:[Object(I.jsx)("label",{htmlFor:"colorBySelect",children:"Color By"}),Object(I.jsx)(ee.a,{menuPosition:"fixed",className:"mb-3",name:"colorBySelect",value:_,isClearable:!0,onChange:function(e){x(e)},options:M.map((function(e){return{value:e,label:e,order:"desc"}}))})]})]})}),b?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(se,{children:Object(I.jsxs)(ce,{enableMove:!1,gridOptions:{w:12,h:25,y:0,x:0},children:[Object(I.jsx)("i",{className:"fas fa-fw fa-sync-alt react-grid-item-hidden",title:"Sync global selection with plot (up to 1000)",onClick:function(){var e=Object.values(n||{}).flat();e.length<=1e3?N(p.reduce((function(t,n){var c=n.value;return Object(a.a)(Object(a.a)({},t),{},Object(r.a)({},c,e.map((function(e){return e.properties[c]})).map((function(e){return[e,e+1e-4]}))))}),{})):N(null)},style:{position:"absolute",zIndex:1,top:3,left:55,cursor:"pointer"}}),Object(I.jsx)("i",{className:"fas fa-fw fa-ban react-grid-item-hidden",title:"Clear selection",onClick:function(){N(null)},style:{position:"absolute",zIndex:1,top:3,left:80,cursor:"pointer"}}),Object(I.jsx)(C,{style:{width:"99%",height:"100%"},data:b.data,layout:b.layout,config:S,onRestyle:function(){var e=b.data[0].dimensions.filter((function(e){return null===e||void 0===e?void 0:e.constraintrange})).reduce((function(e,t){var n;return(null===(n=t.constraintrange)||void 0===n?void 0:n.length)>0?Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},t.label,"number"===typeof t.constraintrange[0]?[t.constraintrange]:t.constraintrange)):e}),{});if(Object.entries(e).length>0){var t=w.reduce((function(t,n){return Object(a.a)(Object(a.a)({},t),{},Object(r.a)({},n.name,n.data.filter((function(t){return Object.entries(e).every((function(e){var n=Object(c.a)(e,2),r=n[0];return n[1].some((function(e){var n,a;return(null===(n=t.properties)||void 0===n?void 0:n[r])>=e[0]&&(null===(a=t.properties)||void 0===a?void 0:a[r])<=e[1]}))}))}))))}),{});N(e),l(Object.entries(t).length>0?t:null)}else N(null),l(null)},onUpdate:function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t[0].dimensions.filter(Boolean).map((function(e){return e.label}));n&&!ne()(n,p.map((function(e){return e.value})))&&O(n.map((function(e){return p.find((function(t){return t.value===e}))})).filter(Boolean))}})]},"parcoordsGridItem")})}):Object(I.jsx)("p",{children:"Please select at least 2 properties from the dropdown."})]})})),be=n(54),je=n(382),me=n(375),fe=n(153),pe=n(18),Oe=n(96),he=n(129);function ve(e){var t=e.selected,n=e.collection,r=o.useState(null),l=Object(c.a)(r,2),s=l[0],u=l[1],d=o.useState(new Set),b=Object(c.a)(d,2),j=b[0],m=b[1],f=o.useState(""),p=Object(c.a)(f,2),O=p[0],v=p[1],_=o.useState([]),x=Object(c.a)(_,2),g=x[0],y=x[1];o.useEffect((function(){u(null),m(new Set)}),[t]);var E=o.useMemo((function(){return Object.keys((null===t||void 0===t?void 0:t.properties)||{})}),[t]),N=o.useMemo((function(){return 0!==g.length&&t?g.map((function(e){var n;return[e,null===(n=t.nearest_neighbors)||void 0===n?void 0:n[e]]})).filter((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return n&&r})):[]}),[g,t]),w=o.useCallback((function(){return N.map((function(e,t){var n=Object(c.a)(e,2),r=n[0],a=(n[1],Object(fe.b)());return a.column("structure"),0===t&&a.column("Occurances"),a.column("Distance_".concat(r)),a.sortBy("Distance_".concat(r)),a}))}),[N]),M=o.useCallback((function(e,t){t.forEach((function(e){var t=e.flatColumns.find((function(e){return e instanceof pe.a&&e.desc.label.toLowerCase().startsWith("distance")}));null===t||void 0===t||t.setFilter({filterMissing:!0,min:-1/0,max:1/0})}))}),[]),P=o.useMemo((function(){return N.reduce((function(e,t){var n=Object(c.a)(t,2);n[0];return n[1].knn_ind.forEach((function(t){e[t]=(e[t]||0)+1})),e}),{})}),[N]),k=o.useMemo((function(){return[{name:"Selection",data:(j.size>0?Array.from(j):Array.from(new Set(N.map((function(e){var t=Object(c.a)(e,2);t[0];return t[1].knn_particles})).flat()))).map((function(e){return Object(a.a)(Object(a.a)({},e),{},{originalParticle:e,properties:Object(a.a)(Object(a.a)({Occurances:N.filter((function(t){var n=Object(c.a)(t,2);n[0];return n[1].knn_particles.includes(e)})).map((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n}))},e.properties),N.reduce((function(t,n){var r=Object(c.a)(n,2),a=r[0],i=r[1],o=i.knn_particles.indexOf(e);return t["Distance_".concat(a)]=o>=0?i.knn_dist[o]:null,t}),{}))})}))}]}),[j,N]),T=o.useCallback((function(e){var t,n;return u(null===(t=Object.values(e||{}).flat())||void 0===t||null===(n=t[0])||void 0===n?void 0:n.originalParticle)}),[]),D=o.useMemo((function(){return Object.fromEntries(N.map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return[n,Object(be.d)(r.knn_dist,[0,1])]})))}),[N]),A=o.useMemo((function(){var e,n=null===t||void 0===t||null===(e=t.nearest_neighbors)||void 0===e?void 0:e[O];return n&&D[O]?Object.fromEntries(n.knn_ind.map((function(e,t){return[e,D[O][t]]}))):null}),[t,O,D]),B=o.useMemo((function(){var e=[];return N.forEach((function(t,n){var r=Object(c.a)(t,2),a=r[0],i=r[1];if(!(n<1)){var o=Object(c.a)(N[n-1],2),l=o[0],s=o[1],u=new Set(s.knn_ind);i.knn_ind.forEach((function(t,n){if(u.has(t)&&(0===j.size||j.has(i.knn_particles[n]))){var r=D[a][n],c=D[l][s.knn_ind.indexOf(t)];e.push({x:[c,r],y:[l,a],type:"scatter",mode:"lines",showlegend:!1,legendgroup:"Pairwise Connections",opacity:Math.abs(c-r)/(i.knn_ind.length/5),line:{color:"gray"}})}}))}})),e}),[N,D,j]),R=o.useMemo((function(){var e=s?N.map((function(e,t){var n=Object(c.a)(e,2),r=n[0],a=n[1],i=a.knn_particles.indexOf(s);return console.log(s.index,a.knn_particles,a.knn_particles.find((function(e){return e.index===s.index}))),i>=0?D[r][i]:NaN})):null;return e?[{x:e.map((function(e){return isNaN(e)?1:e})),y:N.map((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n})),type:"scatter",mode:"lines+markers",showlegend:!1,line:{color:"gold"},marker:{color:e.map((function(e){return isNaN(e)?"red":"gold"}))}}]:[]}),[N,s,D]),L=o.useMemo((function(){return N.map((function(e,t){var n=Object(c.a)(e,2),r=n[0],a=n[1],i=a.knn_ind.map((function(e){return P[e]/N.length}));return A?i=a.knn_ind.map((function(e){return A[e]||NaN})):O&&O.startsWith("property=")&&(i=a.knn_particles.map((function(e){return Object(be.g)(e.properties[O.slice("property=".length)])}))),{x:D[r],y:a.knn_dist.map((function(){return r})),text:a.knn_dist.map((function(e){return"".concat(e," (").concat(a.distance_metric,")")})),hoverinfo:"none",name:r,type:"scatter",mode:"markers",customdata:a.knn_particles.map((function(e){return e.index})),selectedpoints:j.size>0?a.knn_particles.map((function(e,t){return j.has(e)?t:null})).filter((function(e){return null!=e})):void 0,showlegend:!1,showscale:!0,marker:{opacity:.4,color:i,coloraxis:"coloraxis"}}}))}),[N,P,D,O,A,j]),F=[].concat(Object(i.a)(B),Object(i.a)(R),Object(i.a)(L)),U=function(e){var t,r;return n?Array.from(new Set(null===e||void 0===e||null===(t=e.points)||void 0===t||null===(r=t.sort((function(e,t){return+e.x-+t.x})))||void 0===r?void 0:r.map((function(e){return n.data.find((function(t){return t.index===e.customdata}))})))).filter(Boolean):[]};return Object(I.jsxs)("div",{className:"d-flex flex-column",style:{position:"relative"},children:[Object(I.jsx)("p",{className:"text-muted",children:"Inspect the nearest neighbors in the embedding spaces of the selected or hovered structure. Each embedding shows the top-N nearest neighbors according to its distance metric. Generally, the color encodes in how many embeddings a specific neighbor is also listed as neighbor, or if a reference embedding is given, it shows the color of the position in the reference embedding (or black if it is no common neighbor)."}),t&&n?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"row",children:[Object(I.jsxs)("div",{className:"col d-flex flex-column align-items-center justify-content-center",children:[Object(I.jsx)("strong",{children:"Selected"}),(null===t||void 0===t?void 0:t.structure)?Object(I.jsx)(h.a,{style:{width:"100%"},structure:t.structure,align:void 0}):null]}),Object(I.jsxs)("div",{className:"col d-flex flex-column align-items-center",children:[Object(I.jsx)("strong",{children:"Hovered"}),(null===s||void 0===s?void 0:s.structure)?Object(I.jsx)(h.a,{style:{width:"100%"},structure:s.structure,align:void 0}):null]}),Object(I.jsxs)("div",{className:"col d-flex flex-column align-items-center",children:[Object(I.jsx)("strong",{children:"Similarity Map"}),(null===t||void 0===t?void 0:t.structure)&&(null===s||void 0===s?void 0:s.structure)?Object(I.jsx)(h.a,{style:{width:"100%"},structure:[t.structure,s.structure],align:null===t||void 0===t?void 0:t.structure}):null]})]}),Object(I.jsxs)("div",{className:"row",children:[Object(I.jsxs)("div",{className:"col-md-8 mb-3",children:[Object(I.jsx)("label",{children:"Enabled embeddings"}),Object(I.jsx)(Oe.a,{menuPosition:"fixed",isMulti:!0,value:g.map((function(e){return{label:e,value:e}})),onChange:function(e){y(e.map((function(e){return e.value})))},options:[].concat(Object(i.a)(Object.entries((null===t||void 0===t?void 0:t.nearest_neighbors)||{}).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return{label:"".concat(n," (").concat(r.distance_metric,")"),value:n}}))),Object(i.a)(E.map((function(e){return{label:"Property: ".concat(e),value:"property=".concat(e)}})))),closeMenuOnSelect:!1})]}),Object(I.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(I.jsx)("label",{children:"Color by"}),Object(I.jsx)(Oe.a,{menuPosition:"fixed",value:O?{label:O,value:O}:null,isClearable:!0,onChange:function(e){v((null===e||void 0===e?void 0:e.value)||"")},options:[].concat(Object(i.a)(Object.entries((null===t||void 0===t?void 0:t.nearest_neighbors)||{}).map((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n})).map((function(e){return{label:e,value:e}}))),Object(i.a)(E.map((function(e){return{label:"Property: ".concat(e),value:"property=".concat(e)}}))))})]})]}),F.length>0?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(C,{className:"mt-3 mb-5",style:{width:"100%",height:40*N.length+50},data:F,layout:{dragmode:"lasso",hovermode:"closest",autosize:!0,legend:{orientation:"h"},coloraxis:Object(a.a)(Object(a.a)({},ue.c),{},{colorbar:{title:"Distance",titleside:"top",thickness:10,outlinewidth:0,lenmode:"fraction",len:.75,yanchor:"center"}}),scene:{aspectmode:"data"},margin:{r:0,b:0,t:50},yaxis:{categoryorder:"array",categoryarray:N.map((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n})).reverse()}},config:S,onSelected:function(e){m(new Set(U(e)))},onHover:function(e){var t;u(null===(t=U(e))||void 0===t?void 0:t[0])},onUnhover:function(){u(null)}}),Object(I.jsx)("div",{style:{flex:"1 1 500px",display:"flex",overflow:"auto"},children:k?Object(I.jsx)(he.a,{collections:k,setSelected:T,getRankingBuilders:g.length<=1?void 0:w,adjustRankings:0===g.length?void 0:M}):null})]}):null]}):null]})}var _e={dragmode:"lasso",hovermode:"closest",autosize:!0,margin:{r:0,b:0,t:50}},xe=o.memo((function(e){var t=e.collections,n=e.selection,r=o.useState(null),i=Object(c.a)(r,2),l=i[0],s=i[1],u=o.useState([]),d=Object(c.a)(u,2),b=d[0],j=d[1],m=o.useState([]),f=Object(c.a)(m,2),p=f[0],O=f[1],v=o.useMemo((function(){var e,t;return Object.keys((null===l||void 0===l||null===(e=l.data)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.properties)||{})}),[l]),_=o.useState(null),x=Object(c.a)(_,2),g=x[0],y=x[1],E=o.useMemo((function(){if(!l||b.length<2)return[];var e=new Map,t=0,r=[];b.forEach((function(n,a){var c=new Map;l.data.forEach((function(i){var o="".concat(i.properties[n]);c.has(o)||(c.set(o,t++),r.push("".concat(o))),e.has(i)||e.set(i,[]),e.get(i)[a]=c.get(o)})),c.clear()}));var c=null===n||void 0===n?void 0:n[l.name];c&&(c.forEach((function(n){var r;null===(r=e.get(n))||void 0===r||r.push(t)})),r.push("Selection"),t++);var i=new Array(t).fill(null).map((function(){return[]}));e.forEach((function(e,t){e.slice(1).forEach((function(n,r){var a=e[r];i[a][n]=i[a][n]||[],i[a][n].push(t)}))}));var o={source:[],target:[],value:[],customdata:[]};return i.forEach((function(e,t){e.forEach((function(e,n){o.source.push(t),o.target.push(n),o.value.push(e.length),o.customdata.push(e)}))})),console.log(i),[[{type:"sankey",orientation:"h",arrangement:"fixed",node:{label:r,customdata:i.map((function(e,t){return(e[t]||[]).flat()}))},link:Object(a.a)({},o)}]]}),[n,l,b]);return Object(I.jsxs)("div",{className:"d-flex flex-column",style:{position:"relative"},children:[Object(I.jsx)(w.a,{children:g?Object(I.jsx)(h.a,{structure:g.map((function(e){return e.structure})),style:{width:180,backgroundColor:"rgba(255, 255, 255, 0.6)"}}):null}),Object(I.jsx)("p",{className:"text-muted"}),Object(I.jsxs)("div",{className:"row",children:[Object(I.jsxs)("div",{className:"col-md-3 mb-3",children:[Object(I.jsx)("label",{children:"Collection"}),Object(I.jsx)(Oe.a,{menuPosition:"fixed",value:l?{label:l.name,value:l}:null,onChange:function(e){s((null===e||void 0===e?void 0:e.value)||null)},options:t.map((function(e){return{label:e.name,value:e}}))})]}),Object(I.jsxs)("div",{className:"col-md-9 mb-3",children:[Object(I.jsx)("label",{children:"Group by"}),Object(I.jsx)(Oe.a,{menuPosition:"fixed",isDisabled:!l,isMulti:!0,value:b.map((function(e){return{label:e,value:e}})),onChange:function(e){j(e.map((function(e){return e.value})))},options:v.map((function(e){return{label:e,value:e}})),closeMenuOnSelect:!1})]})]}),E.length>0?Object(I.jsxs)(I.Fragment,{children:[E.map((function(e,t){return Object(I.jsx)("div",{children:Object(I.jsx)(C,{className:"mt-3 mb-5",style:{width:"100%",height:500},data:e,layout:_e,config:S,onClick:function(e){O(e.points.map((function(e){return{data:e.customdata,name:"Selection"}})))},onHover:function(e){var t,n=(null===(t=e.points)||void 0===t?void 0:t.map((function(e){return e.customdata||[]})).flat())||[];y(n.length>0?n:null)},onUnhover:function(){y(null)}},t)})})),Object(I.jsx)("div",{style:{flex:"1 1 500px",display:"flex",overflow:"auto"},children:p?Object(I.jsx)(he.a,{collections:p}):null})]}):null]})})),ge=o.memo((function(e){var t=e.collections,n=e.setCollections,l=e.selection,s=e.setSelection,d=e.hover,b=e.setHover,v=e.setVisibleNeighborhoodSamplings,g=o.useMemo((function(){var e;return l?(e=[]).concat.apply(e,Object(i.a)(Object.values(l))):[]}),[l]),y=d||(1===g.length?g[0]:null),E=(1===g.length&&g[0],o.useState(y)),N=Object(c.a)(E,2),M=N[0],P=N[1];o.useEffect((function(){y&&P(y)}),[y]);var k=l&&1===Object.entries(l).length?t.find((function(e){return e.name===Object.keys(l)[0]})):null,A=o.useState(null),B=Object(c.a)(A,2),R=B[0],L=B[1],F=Object(w.b)("newCollectionNameInput",""),U=Object(c.a)(F,3),W=U[0],K=U[1],z=U[2],V=o.useState(!1),q=Object(c.a)(V,2),H=q[0],$=q[1],G=o.useState(""),J=Object(c.a)(G,2),Y=(J[0],J[1],o.useState(!1)),Q=Object(c.a)(Y,2),Z=Q[0],ee=Q[1],te=o.useState(null),ne=Object(c.a)(te,2),re=ne[0],ae=ne[1],ce=o.useState(!1),ie=Object(c.a)(ce,2),oe=ie[0],le=ie[1],se=o.useState(null),ue=Object(c.a)(se,2),fe=ue[0],pe=ue[1],Oe=o.useState(null),he=Object(c.a)(Oe,2),_e=he[0],ge=he[1],ye=o.useState(null),Ee=Object(c.a)(ye,2),Ne=Ee[0],Ce=Ee[1],Se=o.useState(!1),we=Object(c.a)(Se,2),Me=we[0],Pe=we[1],ke=o.useState(null),Ie=Object(c.a)(ke,2),Te=Ie[0],De=Ie[1],Ae=o.useState(null),Be=Object(c.a)(Ae,2),Re=Be[0],Le=Be[1],Fe=o.useState(null),Ue=Object(c.a)(Fe,2),We=Ue[0],Ke=Ue[1],ze=o.useMemo((function(){if(fe){if("collection"===fe.type)return[fe.collection];var e="selection"===fe.type?g:null;return e?Object.entries(_()(e,"collection")).map((function(e){var t=Object(c.a)(e,2);return{name:t[0],data:t[1]}})):null}return null}),[fe,g]);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(f.a,{show:Boolean(R),onHide:function(){return L(null)},size:"xl",children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsx)(f.a.Title,{children:"Available projection models"})}),Object(I.jsx)(f.a.Body,{children:R?Object(I.jsx)("ul",{children:Object.entries(R).filter((function(e){var t=Object(c.a)(e,2);t[0];return t[1].model})).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(I.jsxs)("li",{className:"text-truncate",children:[n,": ",Object(I.jsx)("span",{title:r.model||"",children:r.model})]},n)}))}):null})]}),Object(I.jsx)(f.a,{show:Boolean(fe&&ze),onHide:function(){return pe(null)},size:"xl",dialogClassName:"modal-full-width",children:fe&&ze?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsxs)(f.a.Title,{children:["View ",ze.reduce((function(e,t){return e+t.data.length}),0)," entries"]})}),Object(I.jsx)(f.a.Body,{style:{display:"flex",flexDirection:"column"},children:Object(I.jsx)(u.a,{collections:ze,setSelected:function(e){return ge(e)}})}),Object(I.jsxs)(f.a.Footer,{children:[Object(I.jsx)(p.a,{variant:"primary",onClick:function(){pe(null),s(_e)},disabled:!_e,children:"Save as new selection"}),Object(I.jsx)(p.a,{variant:"secondary",onClick:function(){return pe(null)},children:"Close"})]})]}):null}),Object(I.jsx)(f.a,{show:Boolean(Ne),onHide:function(){return Ce(null)},size:"xl",dialogClassName:"modal-full-width",children:Ne?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsx)(f.a.Title,{children:"View correlation"})}),Object(I.jsxs)(f.a.Body,{style:{display:"flex",flexDirection:"column"},children:[Object(I.jsx)("div",{style:{height:210,visibility:Te?"visible":"hidden",margin:"0px auto"},children:Te?Object(I.jsxs)("div",{className:"d-flex flex-row align-items-center",style:{gap:50},children:[Te.map((function(e){return Object(I.jsx)(h.a,{structure:e,style:{width:210}})})),Te.length>1?Object(I.jsx)(h.a,{structure:Te,style:{width:210}}):null]}):null}),Object(I.jsx)("div",{className:"d-flex flex-row",children:Ne.map((function(e,t){var n=e.data,r=e.layout;return Object(I.jsx)(C,{style:{height:"100%",flex:1},onHover:function(e){e.points[0]&&(De(Array.from(new Set([e.points[0].x,e.points[0].y]))),Le(e.points[0].pointIndex))},onUnhover:function(){De(null),Le(null)},data:Re?[Object(a.a)(Object(a.a)({},n),{},{opacity:.5}),Object(a.a)(Object(a.a)({},n),{},{showlegend:!1,showscale:!1,z:function(){try{var e=n.z;if(Re&&2===Re.length&&e.length>0){var t=Array(e.length).fill(null).map((function(){return Array(e[0].length).fill(null)})),r=Re[0],a=Re[1];return t[r]=e[r],t.forEach((function(t,n){t[a]=e[n][a]})),t}}catch(c){return n.z}}(),opacity:1})]:[n],layout:Object(a.a)({dragmode:"lasso",hovermode:"closest",autosize:!0,legend:{x:1,xanchor:"right",y:1},scene:{aspectmode:"data"},margin:{l:250,r:0,b:0,t:25,pad:4},xaxis:{},yaxis:{scaleanchor:"x",visible:0===t,autorange:"reversed"}},r),config:Object(a.a)(Object(a.a)({},S),{},{displayModeBar:!1})})}))})]}),Object(I.jsx)(f.a.Footer,{children:Object(I.jsx)(p.a,{variant:"secondary",onClick:function(){return Ce(null)},children:"Close"})})]}):null}),Object(I.jsx)(f.a,{show:Boolean(We),onHide:function(){return Ke(null)},size:"xl",dialogClassName:"modal-full-width",children:We?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsxs)(f.a.Title,{children:["View parallel coordinates of ",We.map((function(e){return e.name})).join(", ")]})}),Object(I.jsx)(f.a.Body,{children:Object(I.jsx)(de,{collections:We,selection:l,setSelection:s})}),Object(I.jsx)(f.a.Footer,{children:Object(I.jsx)(p.a,{variant:"secondary",onClick:function(){return Ke(null)},children:"Close"})})]}):null}),Object(I.jsxs)(je.a,{defaultActiveKey:"collections",className:"mt-3 mb-3",unmountOnExit:!0,children:[Object(I.jsx)(me.a,{eventKey:"collections",title:"Collections",children:t.length>0?Object(I.jsx)(I.Fragment,{children:t.map((function(e){return Object(I.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[Object(I.jsxs)("span",{className:"text-truncate me-auto",title:e.name,children:[e.name," ",Object(I.jsx)("small",{children:e.data.length})]}),Object(I.jsxs)("div",{className:"btn-group btn-group-sm ms-2 me-2",role:"group",children:[Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Show parallel coordinates",onClick:function(){Ke([e])},children:Object(I.jsx)("i",{className:"fas fa-fw fa-arrows-alt-h"})}),Object.entries(e.projections||{}).some((function(e){var t=Object(c.a)(e,2);t[0];return t[1].model}))?Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Show attached projection models",onClick:function(){L(e.projections)},children:Object(I.jsx)("i",{className:"fas fa-fw fa-server"})}):null,"neighborhoodSampling"===e.type?Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Show neighborhood grid",onClick:function(){v(e.data)},children:Object(I.jsx)("i",{className:"fas fa-fw fa-th"})}):null,Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Download SMILES as CSV",onClick:function(){Object(be.a)(e.data.map((function(e){return e.structure})).join("\n"),"export")},children:Object(I.jsx)("i",{className:"fas fa-fw fa-cloud-download-alt"})}),Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:"Show collection in table view",onClick:function(){pe({type:"collection",collection:e})},children:Object(I.jsx)("i",{className:"fas fa-fw fa-table"})}),Object(I.jsx)("button",{type:"button",className:"btn btn-light",title:e.hidden?"Enable collection":"Disable collection",onClick:function(){n(t.map((function(t){return e===t?Object(a.a)(Object(a.a)({},e),{},{hidden:!e.hidden}):t})))},children:Object(I.jsx)("i",{className:"fas fa-fw ".concat(e.hidden?"fa-eye-slash":"fa-eye")})}),Object(I.jsx)("button",{type:"button",className:"btn btn-danger",title:"Delete collection",onClick:function(){n(t.filter((function(t){return e!==t})))},children:Object(I.jsx)("i",{className:"fas fa-fw fa-times"})})]})]},e.name)}))}):Object(I.jsx)("p",{className:"lead",children:"No collections found"})}),Object(I.jsxs)(me.a,{eventKey:"selection",title:"Selection",children:[l?Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)("p",{children:[g.length," Selected"," ",Object(I.jsxs)("div",{className:"btn-group btn-group-sm ms-2 me-2 float-end",role:"group",children:[Object(I.jsx)("button",{type:"button",className:"btn btn-sm btn-light",title:"Show in table view",onClick:function(){return pe({type:"selection"})},children:Object(I.jsx)("i",{className:"fas fa-fw fa-table"})}),Object(I.jsx)("button",{type:"button",className:"btn btn-sm btn-light",disabled:Me||g.length>50,title:"Compute distances",onClick:Object(m.a)(j.a.mark((function e(){var t,n,r,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pe(!0),e.next=3,Object(x.b)({structures:g.map((function(e){return{smiles:e.structure}})),include_embedding:!0});case 3:if(!((t=e.sent.data).length>0)){e.next=12;break}return n=t.map((function(e){return t.map((function(t){return e.embedding.cddd.reduce((function(e,n,r){var a=t.embedding.cddd[r];return e+Math.pow(n-a,2)}),0)}))})),r=t.map((function(e){return e.structure})),e.next=9,Promise.all(r.map((function(e){return Object(x.i)(r,e,"ecfp4").then((function(e){return e.tanimoto}))})));case 9:c=e.sent,i=r.map((function(e,t){return r.map((function(e){return c[t][e]||0}))})),Ce([{data:{z:n,reversescale:!0,zmin:0},layout:{title:"CDDD Distance"}},{data:{z:i,zmin:0,zmax:1},layout:{title:"Morgan Similarities"}}].map((function(e){var t=e.data,n=e.layout;return{data:Object(a.a)({x:r,y:r,hoverinfo:"z",colorscale:"YlGnBu",type:"heatmap"},t),layout:n}})));case 12:Pe(!1);case 13:case"end":return e.stop()}}),e)}))),children:Object(I.jsx)("i",{className:"fas fa-fw ".concat(Me?"fa-circle-notch fa-spin":"fa-chess-board")})})]})]})}):null,g.length>0?Object(I.jsxs)(D.a,{title:"Create new collection from selection",open:!0,loading:oe,setLoading:le,onSubmit:Object(m.a)(j.a.mark((function e(){var r,o,u,d,b;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=18;break}if(r=Object.values(l).flat(),re&&1===r.length&&(u=Object.entries(re).filter((function(e){var t=Object(c.a)(e,2);t[0];return t[1]})).map((function(e){var t,n,a,i=Object(c.a)(e,2),o=i[0],l=i[1];return null===(t=r[0].nearest_neighbors)||void 0===t||null===(n=t[o])||void 0===n||null===(a=n.knn_particles)||void 0===a?void 0:a.slice(0,l)})).flat().filter(Boolean),(o=r).push.apply(o,Object(i.a)(u)),r=Array.from(new Set(r))),!H){e.next=12;break}return e.t1=a.a,e.t2={name:W},e.next=8,Object(x.b)({structures:r.map((function(e){return{smiles:e.structure}})),include_embedding:!0});case 8:e.t3=e.sent,e.t0=(0,e.t1)(e.t2,e.t3),e.next=13;break;case 12:e.t0={name:W,data:r.map((function(e){return Object(a.a)(Object(a.a)({},X()(e,(function(e,t,n,r){return"knn_particles"===t?void 0:e}))),{},{nearest_neighbors:void 0})})),projections:null===k||void 0===k?void 0:k.projections};case 13:d=e.t0,b=Z?t.map((function(e){return l[e.name]?Object(a.a)(Object(a.a)({},e),{},{data:e.data.filter((function(t){return!l[e.name].includes(t)}))}):e})):t,n([].concat(Object(i.a)(b),[d])),s(null),K("");case 18:case"end":return e.stop()}}),e)}))),children:[Object(I.jsx)("div",{className:"d-flex justify-content-center",children:1===g.length?Object(I.jsx)(O.a,{structure:g[0],showProperties:!1}):Object(I.jsx)(h.a,{style:{maxWidth:"100%"},structure:g.map((function(e){return e.structure}))})}),z,Object(I.jsxs)("div",{className:"form-check form-switch me-sm-2",children:[Object(I.jsx)("input",{type:"checkbox",className:"form-check-input",id:"collectionsRecomputeEmbeddingsInput",checked:H,onChange:function(e){return $(e.currentTarget.checked)}}),Object(I.jsx)("label",{className:"form-check-label",htmlFor:"collectionsRecomputeEmbeddingsInput",children:"Recompute embeddings, projections, ..."})]}),Object(I.jsxs)("div",{className:"form-check form-switch me-sm-2",children:[Object(I.jsx)("input",{type:"checkbox",className:"form-check-input",id:"collectionsRemoveOldInput",checked:Z,onChange:function(e){return ee(e.currentTarget.checked)}}),Object(I.jsx)("label",{className:"form-check-label",htmlFor:"collectionsRemoveOldInput",children:"Remove from original collection"})]}),1===g.length&&g[0].nearest_neighbors?Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"form-check form-switch me-sm-2",children:[Object(I.jsx)("input",{type:"checkbox",className:"form-check-input",id:"collectionsEnableKNN",checked:Boolean(re),onChange:function(e){return ae(e.currentTarget.checked?{}:null)}}),Object(I.jsx)("label",{className:"form-check-label",htmlFor:"collectionsEnableKNN",children:"Enable KNN"})]}),re&&Object.entries(g[0].nearest_neighbors||{}).map((function(e){var t=Object(c.a)(e,2),n=t[0],i=t[1];return Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("label",{htmlFor:"neighborhoodSamplesInput",className:"form-label",children:[n," ",null===re||void 0===re?void 0:re[n]]}),Object(I.jsx)("input",{type:"range",className:"form-range",id:"neighborhoodSamplesInput",value:(null===re||void 0===re?void 0:re[n])||0,onChange:function(e){return ae(Object(a.a)(Object(a.a)({},re||{}),{},Object(r.a)({},n,e.currentTarget.valueAsNumber)))},min:0,max:i.knn_ind.length,step:1})]})}))]}):null,Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:oe,disabled:!l||!W,text:"Create"})})]}):Object(I.jsx)("p",{className:"lead",children:"Select to create a new collection"})]}),Object(I.jsx)(me.a,{eventKey:"knn",title:"KNN",children:Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(ve,{selected:M,collection:t.find((function(e){return e.name===(null===y||void 0===y?void 0:y.collection)})),setHover:b,hover:d})})}),Object(I.jsx)(me.a,{eventKey:"sankey",title:"Group Flow",children:Object(I.jsx)(xe,{selection:l,collections:t})}),Object(I.jsx)(me.a,{eventKey:"details",title:"Details",children:y?Object(I.jsx)(O.a,{structure:y}):Object(I.jsx)("p",{className:"lead",children:"Hover over a structure to see details"})})]})]})})),ye=n(67),Ee=n(104),Ne=n.n(Ee),Ce=n(376),Se=n(89),we="Trajectories",Me=o.memo((function(e){var t=e.title,n=e.collections,r=e.xAccessor,l=e.yAccessor,s=e.options,u=e.hover,d=e.setHover,b=e.selected,j=e.setSelected,m=e.children,f=o.useState(null),p=Object(c.a)(f,2),O=p[0],h=p[1],v=o.useState(null),x=Object(c.a)(v,2),g=x[0],y=x[1],E=g||u,N=Object(w.c)(d);o.useEffect((function(){var e,t=(null===(e=function(){var e=s.connectBy;if(!e||0===e.length||null==E&&!b)return null;var t=new Map;return b&&Object.entries(b).forEach((function(e){var r=Object(c.a)(e,2),a=r[0],i=r[1],o=n.find((function(e){return e.name===a}));t.set(o,i)})),t.delete(void 0),E||0!==t.size?[E?[n.find((function(e){return e.name===E.collection})),[E]]:[void 0,void 0]].concat(Object(i.a)(Array.from(t.entries()))).map((function(t,n){var a,o=Object(c.a)(t,2),s=o[0],u=o[1];if(!s||!u)return null;var d=s.data,b=0===n,j=e.filter((function(e){return e.startsWith("knn=")})).map((function(e){return e.split("=")})),m=j.length>0,f=null;if(m)f=d;else{var p=e.map((function(e){return new Set(u.map((function(t){var n,r;return null===t||void 0===t||null===(n=t.properties)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.toString()})).filter((function(e){return null!=e})))}));f=d.filter((function(t){return e.every((function(e,n){var r,a;return p[n].has(null===(r=t.properties)||void 0===r||null===(a=r[e])||void 0===a?void 0:a.toString())}))}))}if(0===f.length)return null;var O=[],h=[],v=[],x=Object(Ce.a)().range([.1,.8]).domain([d.length,0]),g=null===(a=Object(Se.e)("rgb(0,0,0)"))||void 0===a?void 0:a.darker(),y=g.copy();y.opacity=x(f.length),g.opacity=.5;var N=Object(U.a)().range([6,12]),C=null;C=m?j.map((function(e){var t,n;return[e[1],[E].concat(Object(i.a)((null===E||void 0===E||null===(t=E.nearest_neighbors)||void 0===t||null===(n=t[e[1]])||void 0===n?void 0:n.knn_particles.slice(0,+e[2]).reverse().filter(Boolean))||[]))]})):Object.entries(_()(f,(function(t){return e.map((function(e){var n;return"".concat(e,":").concat(null===(n=t.properties)||void 0===n?void 0:n[e])})).join(", ")})));var S,w=Object(ye.a)(C);try{var M=function(){var e=Object(c.a)(S.value,2),t=(e[0],e[1]);t=t.filter((function(e){return null!=Ne()(e,r)&&null!=Ne()(e,l)}));var n=N.domain([0,t.length]);O.push.apply(O,Object(i.a)(t)),O.push(null),h.push.apply(h,Object(i.a)(t.map((function(e,t){return n(t)})))),h.push(null),v.push.apply(v,Object(i.a)(t.map((function(e,t){return e===E||e.selected?"gold":"lightgray"})))),v.push("darkblue")};for(w.s();!(S=w.n()).done;)M()}catch(k){w.e(k)}finally{w.f()}var P=v.map((function(e){return Object(Se.e)(e).darker().toString()}));return{type:b?"scatter":"scattergl",mode:"lines+markers",x:O.map((function(e){var t;return null!==(t=Ne()(e,r))&&void 0!==t?t:NaN})),y:O.map((function(e){var t;return null!==(t=Ne()(e,l))&&void 0!==t?t:NaN})),name:we,hoverinfo:"skip",marker:{color:v,size:h,line:{color:P,width:2},opacity:1},colorscale:[[0,"##a2d4d5"],[1,"#127273"]],line:{color:y.toString(),width:m?0:2,shape:"spline"},showlegend:!1}})):null}())||void 0===e?void 0:e.filter(Boolean))||[];h((function(e){if(!e)return e;var n=e.data.find((function(e){return e.name===we}));if(0===t.length&&!n)return e;var r=[].concat(Object(i.a)(e.data.filter((function(e){return e.name!==we})).map((function(e){return Object(a.a)(Object(a.a)({},e),{},{opacity:t.length>0?.4:void 0})}))),Object(i.a)(t));return Object(a.a)(Object(a.a)({},e),{},{data:r})}))}),[n,r,l,s.connectBy,E,b]),o.useEffect((function(){var e=setTimeout((function(){h((function(e){var c=n.map((function(e){var t=e.data,n=e.hidden,r=e.name,a=e.plotOptions,c=(null===a||void 0===a?void 0:a.colorBy)||s.colorBy,i=(null===a||void 0===a?void 0:a.opacityBy)||s.opacityBy,o=(null===a||void 0===a?void 0:a.sizeBy)||s.sizeBy,l=c?t.map((function(e){var t;return Object(be.g)(null===(t=e.properties)||void 0===t?void 0:t[c])})):void 0,u="number"===typeof i?i:void 0,d=i?t.map((function(e){var t;return u||Object(be.g)(null===(t=e.properties)||void 0===t?void 0:t[i])})):void 0,b=o?t.map((function(e){var t;return Object(be.g)(null===(t=e.properties)||void 0===t?void 0:t[o],5)})):void 0;return{data:t,hidden:n,name:r,plotOptions:a,colorExtent:l?Object(W.a)(l):void 0,color:l,opacity:d,opacityExtent:d?Object(W.a)(d):void 0,size:b,sizeExtent:b?Object(W.a)(b):void 0}})),o=Object(be.f)(c,(function(e){return e.colorExtent})),u=(Object(be.f)(c,(function(e){return e.opacityExtent})),s.sizeBy?2*Math.max.apply(Math,Object(i.a)(c.map((function(e){var t=e.sizeExtent;return(null===t||void 0===t?void 0:t[1])||0}))))/Math.pow(5,2):void 0);return{frames:[],layout:Object(a.a)(Object(a.a)({},(null===e||void 0===e?void 0:e.layout)||{}),{},{colorway:ue.b,dragmode:"lasso",hovermode:"closest",autosize:!0,legend:{x:1,xanchor:"right",y:1.5,bgcolor:"rgba(255, 255, 255, 0.5)"},title:t,margin:{r:0,pad:4}}),data:c.map((function(t,n){var c,i,d=t.data,b=t.name,j=t.hidden,m=t.color,f=t.opacity,p=t.size,O=t.plotOptions,h=(null===e||void 0===e?void 0:e.data.find((function(e){return e.name===b})))||{},v=(null===O||void 0===O?void 0:O.groupBy)||s.groupBy,_=(null===O||void 0===O?void 0:O.colorBy)||s.colorBy,x=v?d.map((function(e){var t,n;return(null===(t=e.properties)||void 0===t||null===(n=t[v])||void 0===n?void 0:n.toString())||"N/A"})):void 0,g=d.map((function(e){return Ne()(e,r)})),y=d.map((function(e){return Ne()(e,l)})),E=d.map((function(e,t){return[t,e.index]}));if((null===(c=y)||void 0===c?void 0:c[0])&&Array.isArray(y[0])){var N=y.map((function(e,t){return{x:Array.from(new Array(e.length).keys()),y:e,indices:new Array(e.length).fill(null).map((function(){return[t,d[t].index]})),color:Array.isArray(m)?new Array(e.length).fill(m[t]):m,opacity:Array.isArray(f)?new Array(e.length).fill(f[t]):f,size:Array.isArray(p)?new Array(e.length).fill(p[t]):p,groups:Array.isArray(x)?new Array(e.length).fill(x[t]):x}}));g=N.map((function(e){return e.x})).flat(),y=N.map((function(e){return e.y})).flat(),E=N.map((function(e){return e.indices})).flat(),m=Array.isArray(m)?N.map((function(e){return e.color})).flat():m,f=Array.isArray(f)?N.map((function(e){return e.opacity})).flat():f,p=Array.isArray(p)?N.map((function(e){return e.size})).flat():p,x=Array.isArray(x)?N.map((function(e){return e.groups})).flat():x}return console.log(m),Object(a.a)(Object(a.a)({},h),{},{x:g,y:y,text:d.map((function(e){return e.structure})),hoverinfo:"none",name:b,type:"scattergl",mode:"markers",customdata:E,visible:!j||"legendonly",showlegend:!1,marker:Object(a.a)(Object(a.a)({},h.marker||{}),{},{color:m,cmin:null===o||void 0===o?void 0:o[0],cmax:null===o||void 0===o?void 0:o[1],opacity:f?Object(be.d)(f,[.1,.9]):(d.length,.5),symbol:n,size:null!==(i=p)&&void 0!==i?i:d.length>=5e3?3.5:5,sizeref:u,sizemin:2,sizemax:5,colorbar:_?{title:_.length>10?_.slice(0,7)+"...":_,titleside:"top",thickness:10,outlinewidth:0,lenmode:"fraction",len:.75,yanchor:"middle"}:void 0},ue.c),transforms:v?[{type:"groupby",groups:x,styles:Array.from(new Set(x)).sort((function(e,t){return e.localeCompare(t)})).map((function(e,t){return{target:e,value:{marker:{symbol:t}}}}))}]:[]})}))}}))}),300);return function(){clearTimeout(e)}}),[t,n,r,l,JSON.stringify(s)]),o.useEffect((function(){h((function(e){return e?Object(a.a)(Object(a.a)({},e),{},{data:e.data.map((function(e){var t,n=new Set((null===b||void 0===b||null===(t=b[e.name])||void 0===t?void 0:t.map((function(e){return e.index})))||[]),r=void 0;return n.size>0&&(r=[],e.customdata.forEach((function(e,t){var a=Object(c.a)(e,2),i=(a[0],a[1]);n.has(i)&&r.push(t)}))),Object(a.a)(Object(a.a)({},e),{},{selectedpoints:r})}))}):null}))}),[b]),o.useEffect((function(){var e=setTimeout((function(){var e;return null===(e=N.current)||void 0===e?void 0:e.call(N,g)}),50);return function(){clearTimeout(e)}}),[g,N]);var M=function(e){var t=(null===e||void 0===e?void 0:e.points)||[],r=new Set;return t.length>0?t.reduce((function(e,t){var a,i=null===n||void 0===n?void 0:n[t.curveNumber],o=t.customdata,l=Object(c.a)(o,2),s=l[0],u=(l[1],null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a[s]);return u&&!r.has(s)&&(r.add(s),e[i.name]||(e[i.name]=[]),e[i.name].push(u)),e}),{}):null};return Object(I.jsxs)(I.Fragment,{children:[O?Object(I.jsx)(C,{style:{width:"100%",height:"100%"},data:O.data,layout:O.layout,config:S,onSelected:function(e){j(M(e))},onDeselect:function(){j(null)},onClick:function(e){j(M(e)),y(null)},onHover:function(e){var t;y(null===(t=Object.values(M(e)).flat())||void 0===t?void 0:t[0])},onUnhover:function(){y(null)},onUpdate:function(e){O.data=e.data,O.frames=e.frames,O.layout=e.layout}}):null,m]})})),Pe=n(183),ke=function(e){var t=e.addCollection,n=e.selection,r=e.loading,i=e.setLoading,l=o.useState(""),s=Object(c.a)(l,2),u=s[0],d=s[1],b=Object(w.b)("mmpNameInput","MMP ".concat(u)),f=Object(c.a)(b,3),p=f[0],O=f[1],h=f[2],v=o.useState(""),_=Object(c.a)(v,2),g=_[0],y=_[1],E=o.useState(0),N=Object(c.a)(E,2),C=N[0],S=N[1],M=o.useState(1),P=Object(c.a)(M,2),k=P[0],A=P[1],B=o.useState(0),L=Object(c.a)(B,2),F=L[0],U=L[1],W=o.useState(0),K=Object(c.a)(W,2),z=K[0],V=K[1],q=o.useState(0),H=Object(c.a)(q,2),$=H[0],G=H[1];return Object(I.jsxs)(D.a,{title:Object(I.jsxs)(I.Fragment,{children:["Matched Molecular Pairs \xa0",Object(I.jsx)("a",{style:{fontSize:"smaller"},href:"https://github.com/rdkit/mmpdb#4-identify-possible-transforms",target:"_blank",rel:"noreferrer",children:Object(I.jsx)("i",{className:"fas fa-fw fa-info-circle"})})]}),loading:r,setLoading:i,onSubmit:Object(m.a)(j.a.mark((function e(){var n,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.d)({structure:u,substructure:g,min_variable_size:C,max_variable_size:k,min_constant_size:F,min_radius:z,min_pairs:$});case 2:if(n=e.sent,0!==(r=n.structures).length){e.next=6;break}throw Error("No matching pairs found");case 6:return e.next=8,Object(x.b)({structures:r.map((function(e){return{smiles:e}})),include_embedding:!0});case 8:c=e.sent,t(Object(a.a)({name:p},c)),O("");case 11:case"end":return e.stop()}}),e)}))),children:[h,Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"mmpStructureInput",children:"Structure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:u,selection:n,setValue:d}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"mmpStructureInput","aria-describedby":"mmpStructureInput",value:u,onChange:function(e){return d(e.currentTarget.value)}})]})]}),Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:"Advanced Settings"}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"minVariableSizeInput",children:"Min Variable Size"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"minVariableSizeInput",value:C,required:!0,min:0,onChange:function(e){return S(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"maxVariableSizeInput",children:"Max Variable Size"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"maxVariableSizeInput",value:k,required:!0,min:0,onChange:function(e){return A(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"minConstantSizeInput",children:"Min Constant Size"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"minConstantSizeInput",value:F,required:!0,min:0,onChange:function(e){return U(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"minRadiusInput",children:"Min Radius"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"minRadiusInput",value:z,min:0,required:!0,onChange:function(e){return V(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"minPairsInput",children:"Min Pairs"}),Object(I.jsx)("input",{type:"number",className:"form-control form-control-sm",id:"minPairsInput",value:$,min:0,required:!0,onChange:function(e){return G(e.currentTarget.valueAsNumber)}})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"mmpSmartsStructureInput",children:"SMARTS Substructure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:g,selection:n,setValue:y}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"mmpSmartsStructureInput","aria-describedby":"mmpSmartsStructureInput",value:g,onChange:function(e){return y(e.currentTarget.value)}})]})]})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:r,disabled:!u,text:"Compute MMP"})})]})},Ie=function(e){var t=e.visible,n=e.setVisible,r=e.collections,l=e.setCollections,s=e.selection,u=e.loading,d=e.setLoading,b=o.useState(""),p=Object(c.a)(b,2),O=p[0],v=p[1],_=o.useState("chembl_pca"),g=Object(c.a)(_,2),y=g[0],E=g[1],N=o.useState(5),C=Object(c.a)(N,2),S=C[0],M=C[1],P=o.useState(1),k=Object(c.a)(P,2),A=k[0],B=k[1],L=Object(w.b)("neighborhoodNameInput","".concat(y," ").concat(S,"*").concat(A," Neighborhood of ").concat(O)),F=Object(c.a)(L,3),U=F[0],W=F[1],K=F[2],z=function(){var e=Object(m.a)(j.a.mark((function e(){var t,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.e)(O,S,y,A);case 2:return t=e.sent,e.next=5,Object(x.i)(t.data.map((function(e){return e.structure})),O,"ecfp4");case 5:c=e.sent,o=t.data.map((function(e){return Object(a.a)(Object(a.a)({},e),{},{properties:Object(a.a)(Object(a.a)({},e.properties||{}),{},{neighborhoodSimilarity:c.tanimoto[e.structure]})})})),l([].concat(Object(i.a)(r),[Object(a.a)(Object(a.a)({},t),{},{name:U,data:o,type:"neighborhoodSampling"})])),W(""),n(o);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(f.a,{show:Boolean(t),onHide:function(){return n(null)},size:"xl",children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsx)(f.a.Title,{children:"Neighborhood Sampling"})}),Object(I.jsx)(f.a.Body,{children:t?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(Math.sqrt(t.length),", 1fr)")},children:t.map((function(e,n){var r,a;return Object(I.jsx)(h.a,{structure:e.structure,align:t[Math.floor(t.length/2)].structure,title:"Similarity to reference: ".concat(null===(r=e.properties)||void 0===r?void 0:r.neighborhoodSimilarity),style:{width:"100%",opacity:null===(a=e.properties)||void 0===a?void 0:a.neighborhoodSimilarity,border:"1px solid ".concat(Math.floor(t.length/2)===n?"gold":"rgba(0, 0, 0, 0.05)")}},n)}))})}):null})]}),Object(I.jsxs)(D.a,{title:"Neighborhood Sampling",loading:u,setLoading:d,onSubmit:z,children:[K,Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"neighborhoodStructureInput",children:"Reference structure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:O,selection:s,setValue:v}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"neighborhoodStructureInput","aria-describedby":"neighborhoodStructureInput",value:O,onChange:function(e){return v(e.currentTarget.value)}})]})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("label",{htmlFor:"neighborhoodSamplesInput",className:"form-label",children:["Nr. of Samples: ",S]}),Object(I.jsx)("input",{type:"range",className:"form-range",id:"neighborhoodSamplesInput",value:S,onChange:function(e){return M(e.currentTarget.valueAsNumber)},min:3,max:15,step:2})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("label",{htmlFor:"neighborhoodScaleInput",className:"form-label",children:["Scale: ",A]}),Object(I.jsx)("input",{type:"range",className:"form-range",id:"neighborhoodScaleInput",value:A,onChange:function(e){return B(e.currentTarget.valueAsNumber)},min:.1,max:5,step:.1})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"neighborhoodSamplesMethod",children:"Method"}),Object(I.jsx)("div",{className:"input-group input-group-sm",children:Object(I.jsxs)("select",{className:"form-control",id:"neighborhoodSamplesMethod",value:y,onChange:function(e){E(e.currentTarget.value)},children:[Object(I.jsx)("option",{value:"chembl_pca",children:"PCA of ChEMBL"}),Object(I.jsx)("option",{value:"random_orthogonal",children:"Random Orthogonal"})]})})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:u,disabled:!O,text:"Compute Neighbors"})})]})]})},Te=function(e){var t=e.collections,n=e.setCollections,i=(e.selection,e.loading),l=e.setLoading,s=o.useState(null),u=Object(c.a)(s,2),d=u[0],b=u[1],f=o.useState("all"),p=Object(c.a)(f,2),O=p[0],h=p[1],v=o.useState(null),_=Object(c.a)(v,2),g=_[0],y=_[1],E=function(){var e=Object(m.a)(j.a.mark((function e(){var i,o,l,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===d||void 0===d?void 0:d.projections)&&g&&O)){e.next=10;break}return e.next=3,Object(x.a)(g.data,"all"===O?Object.entries(d.projections).reduce((function(e,t){var n=Object(c.a)(t,2),i=n[0],o=n[1];return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},i,o.model))}),{}):Object(r.a)({},O,d.projections[O].model));case 3:i=e.sent,o=function(e){return"".concat(d.name,"_").concat(e,"_base")},l=Object(a.a)(Object(a.a)({},g),{},{data:g.data.map((function(e,t){return Object(a.a)(Object(a.a)({},e),{},{projection:Object(a.a)(Object(a.a)({},e.projection),Object.entries(i.projection).reduce((function(e,n){var i=Object(c.a)(n,2),l=i[0],s=i[1];return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},o(l),s[t]))}),{}))})})),projections:Object(a.a)(Object(a.a)({},g.projections||{}),Object.entries(i.projections||{}).reduce((function(e,t){var n=Object(c.a)(t,2),i=n[0],l=n[1];return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},o(i),l))}),{}))}),s=Object(a.a)(Object(a.a)({},d),{},{data:d.data.map((function(e){return Object(a.a)(Object(a.a)({},e),{},{projection:Object(a.a)(Object(a.a)({},e.projection),Object.keys(i.projection).reduce((function(t,n){return Object(a.a)(Object(a.a)({},t),{},Object(r.a)({},o(n),e.projection[n]))}),{}))})}))}),n(t.map((function(e){return e===g?l:e===d?s:e}))),y(l),b(s);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=t.filter((function(e){return e.projections&&Object.entries(e.projections).some((function(e){var t=Object(c.a)(e,2);t[0];return t[1].model}))})),C=t.filter((function(e){var t,n;return(null===(t=e.data)||void 0===t?void 0:t[0].embedding)&&Object.entries(null===(n=e.data)||void 0===n?void 0:n[0].embedding).length>0}));return Object(I.jsx)(D.a,{title:"Recompute Projections",loading:i,setLoading:l,onSubmit:E,children:N.length>0?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"recomputeProjectionFrom",children:"Reference collection"}),Object(I.jsx)("div",{className:"input-group input-group-sm",children:Object(I.jsxs)("select",{className:"form-control",id:"recomputeProjectionFrom",value:null===d||void 0===d?void 0:d.name,onChange:function(e){var n=e.currentTarget.value;b(n?t.find((function(e){return e.name===n})):null)},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),N.map((function(e){return Object(I.jsx)("option",{value:e.name,children:e.name},e.name)}))]})})]}),d?Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"recomputeProjectionProjection",children:"Projection"}),Object(I.jsx)("div",{className:"input-group input-group-sm",children:Object(I.jsxs)("select",{className:"form-control",id:"recomputeProjectionProjection",value:O||void 0,onChange:function(e){h(e.currentTarget.value)},children:[Object(I.jsx)("option",{value:"all",children:"All"}),Object.entries((null===d||void 0===d?void 0:d.projections)||{}).filter((function(e){var t=Object(c.a)(e,2);t[0];return t[1].model})).map((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return Object(I.jsx)("option",{value:n,children:n})}))]})})]}):null,Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"recomputeProjectionTo",children:"Subset collection"}),Object(I.jsx)("div",{className:"input-group input-group-sm",children:Object(I.jsxs)("select",{className:"form-control",id:"recomputeProjectionTo",value:null===g||void 0===g?void 0:g.name,onChange:function(e){var n=e.currentTarget.value;y(n?t.find((function(e){return e.name===n})):null)},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),C.map((function(e){return Object(I.jsx)("option",{value:e.name,children:e.name})}))]})})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:i,disabled:Boolean(!d||!g||d===g),text:"Compute Projections"})})]}):Object(I.jsx)("p",{children:"At least 2 collections must be available."})})},De=function(e){var t=e.addCollection,n=e.selection,r=e.loading,i=e.setLoading,l=o.useState(""),s=Object(c.a)(l,2),u=s[0],d=s[1],b=Object(w.b)("stonedSelfiesNameInput","SELFIES ".concat(u)),f=Object(c.a)(b,3),p=f[0],O=f[1],h=f[2],v=o.useState(""),_=Object(c.a)(v,2),g=_[0],y=_[1],E=o.useState(1e3),N=Object(c.a)(E,2),C=N[0],S=N[1],M=o.useState(5),P=Object(c.a)(M,2),k=P[0],A=P[1];return Object(I.jsxs)(D.a,{title:Object(I.jsxs)(I.Fragment,{children:["Stoned Selfies \xa0",Object(I.jsx)("a",{style:{fontSize:"smaller"},href:"https://github.com/aspuru-guzik-group/stoned-selfies",target:"_blank",rel:"noreferrer",children:Object(I.jsx)("i",{className:"fas fa-fw fa-info-circle"})})]}),loading:r,setLoading:i,onSubmit:Object(m.a)(j.a.mark((function e(){var n,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.h)({structure:u,substructure:g,random_samples:C,max_mutations:k});case 2:if(n=e.sent,0!==(r=n.structures).length){e.next=6;break}throw Error("No stoned selfies found");case 6:return e.next=8,Object(x.b)({structures:r.map((function(e){return{smiles:e}})),include_embedding:!0});case 8:c=e.sent,t(Object(a.a)({name:p},c)),O("");case 11:case"end":return e.stop()}}),e)}))),children:[h,Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"stonedSelfiesStructureInput",children:"Structure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:u,selection:n,setValue:d}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"stonedSelfiesStructureInput","aria-describedby":"stonedSelfiesStructureInput",value:u,onChange:function(e){return d(e.currentTarget.value)}})]})]}),Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:"Advanced Settings"}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsx)("label",{htmlFor:"stonedSelfiesSubstructureInput",children:"Substructure"}),Object(I.jsxs)("div",{className:"input-group input-group-sm",children:[Object(I.jsx)(R,{value:g,selection:n,setValue:y}),Object(I.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"stonedSelfiesSubstructureInput","aria-describedby":"stonedSelfiesSubstructureInput",value:g,onChange:function(e){return y(e.currentTarget.value)}})]})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("label",{htmlFor:"stonedSelfiesRandomSamplesInput",className:"form-label",children:["Nr. of Random Samples: ",C]}),Object(I.jsx)("input",{type:"range",className:"form-range",id:"stonedSelfiesRandomSamplesInput",value:C,onChange:function(e){return S(e.currentTarget.valueAsNumber)},min:500,max:5e4})]}),Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("label",{htmlFor:"stonedSelfiesMaxPermutationsInput",className:"form-label",children:["Maximum Permutations: ",k]}),Object(I.jsx)("input",{type:"range",className:"form-range",id:"stonedSelfiesMaxPermutationsInput",value:k,onChange:function(e){return A(e.currentTarget.valueAsNumber)},min:1,max:20})]})]}),Object(I.jsx)("div",{className:"text-end",children:Object(I.jsx)(T,{loading:r,disabled:!u,text:"Compute"})})]})},Ae=n(143),Be=n.n(Ae);function Re(e){var t=e.inline,n=void 0===t||t,r=e.multi,c=e.option,l=e.setOption,s=e.label,u=e.options,d=e.id,b=(e.disabled,e.availableNearestNeighbors),j=e.availableClusters,m=e.availableProperties,f=e.extensions,p=o.useMemo((function(){return Be()(c).filter(Boolean)}),[c]);return Object(I.jsxs)("div",{className:"d-flex position-relative ".concat(n?"col-sm-3":"col-12"),children:[s?Object(I.jsx)("label",{className:"my-1 me-2 align-self-center ".concat(n?"":"col-sm-2 d-flex"),style:{whiteSpace:"nowrap"},htmlFor:d,children:s}):null,Object(I.jsx)("div",{className:"my-1 me-sm-2 flex-fill ".concat(n?"":"col-sm-10"),style:{minWidth:100},children:Object(I.jsxs)("div",{className:"row",children:[Object(I.jsx)("div",{className:"col",children:Object(I.jsx)(Oe.a,{menuPosition:"fixed",isMulti:r,isClearable:!0,styles:{menu:function(e){return Object(a.a)(Object(a.a)({},e),{},{zIndex:999})}},onCreateOption:function(e){l(e)},value:p.map((function(e){return{label:e,value:e}})),onChange:function(e){if(e){var t,n=Be()(e);if(r)l(n.map((function(e){return e.value})));else l(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.value)}else l(null)},options:[].concat(Object(i.a)((f||[]).map((function(e){return e.additionalOptions||[]})).flat()),Object(i.a)(u.map((function(e){return{label:e,value:e}}))))})}),null===f||void 0===f?void 0:f.map((function(e){return Object(I.jsx)(e.component,{setOption:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(!e)return null;var t=Be()(e);l(r?t.map((function(e){return e})):null===t||void 0===t?void 0:t[0])})),availableNearestNeighbors:b,availableClusters:j,availableProperties:m,option:null===p||void 0===p?void 0:p[0]})}))]})})]})}var Le=n(138),Fe=n.n(Le),Ue={component:function(e){var t=e.option,n=e.setOption,r=e.availableNearestNeighbors,a=(null===t||void 0===t?void 0:t.split("="))||[],i=Object(c.a)(a,4),o=i[0],l=i[1],s=i[2],u=i[3];return"jaccard"===o?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:l||"",onChange:function(e){return n("jaccard=".concat(e.currentTarget.value,"=").concat(s||"","=").concat(u||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),r.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:s||"",onChange:function(e){return n("jaccard=".concat(l||"","=").concat(e.currentTarget.value,"=").concat(u||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),r.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsx)("input",{className:"form-control",type:"number",min:1,max:50,value:+u||"",onChange:function(e){return n("jaccard=".concat(l||"","=").concat(s||"","=").concat(e.currentTarget.value))}})})]}):null},additionalOptions:[{label:"Ratio of matching nearest neighbors",value:"jaccard="}]},We={component:function(e){var t=e.option,n=e.setOption,r=e.availableNearestNeighbors,a=e.availableProperties,i=(null===t||void 0===t?void 0:t.split("="))||[],o=Object(c.a)(i,5),l=o[0],s=o[1],u=o[2],d=o[3],b=o[4];return"nn_diff"===l?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:s||"",onChange:function(e){return n("nn_diff=".concat(e.currentTarget.value,"=").concat(u||"","=").concat(d||"","=").concat(b||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),r.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:u||"",onChange:function(e){return n("nn_diff=".concat(s||"","=").concat(e.currentTarget.value,"=").concat(d||"","=").concat(b||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),a.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:d||"",onChange:function(e){return n("nn_diff=".concat(s||"","=").concat(u||"","=").concat(e.currentTarget.value,"=").concat(b||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),Object.keys(ue.a).map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsx)("input",{className:"form-control",type:"number",min:1,max:50,value:+b||"",onChange:function(e){return n("nn_diff=".concat(s||"","=").concat(u||"","=").concat(d||"","=").concat(e.currentTarget.value))}})})]}):null},additionalOptions:[{label:"Properties of nearest neighbors",value:"nn_diff="}]},Ke={component:function(e){var t=e.option,n=e.setOption,r=e.availableNearestNeighbors,a=(null===t||void 0===t?void 0:t.split("="))||[],i=Object(c.a)(a,3),o=i[0],l=i[1],s=i[2];return"knn"===o?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:l||"",onChange:function(e){return n("knn=".concat(e.currentTarget.value,"=").concat(s||""))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),r.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})}),Object(I.jsx)("div",{className:"col",children:Object(I.jsx)("input",{className:"form-control",type:"number",min:1,max:50,value:+s||"",onChange:function(e){return n("knn=".concat(l||"","=").concat(e.currentTarget.value))}})})]}):null},additionalOptions:[{label:"K-Nearest Neighbors",value:"knn="}]},ze={component:function(e){var t=e.option,n=e.setOption,r=(e.availableNearestNeighbors,e.availableClusters),a=(e.availableProperties,(null===t||void 0===t?void 0:t.split("="))||[]),i=Object(c.a)(a,2),o=i[0],l=i[1];return"cluster"===o?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("div",{className:"col",children:Object(I.jsxs)("select",{className:"form-control",value:l||"",onChange:function(e){return n("cluster=".concat(e.currentTarget.value))},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),r.map((function(e){return Object(I.jsx)("option",{value:e,children:e})}))]})})}):null},additionalOptions:[{label:"Clusters",value:"cluster="}]},Ve={component:function(e){var t=e.option,n=e.setOption,r=(null===t||void 0===t?void 0:t.split("="))||[],a=Object(c.a)(r,2),i=a[0],o=a[1];return"eval"===i?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("div",{className:"col-8",children:Object(I.jsxs)("div",{className:"input-group",children:[Object(I.jsx)("span",{className:"input-group-text",children:Object(I.jsxs)("code",{children:["(p) =",">"," "]})}),Object(I.jsx)("input",{className:"form-control",type:"text",value:o||"",onChange:function(e){return n("eval=".concat(e.currentTarget.value||""))}})]})})}):null},additionalOptions:[{label:"Custom function",value:"eval="}]},qe=function(e){var t=e.inline,n=e.config,r=e.setConfig,i=e.availableProjections,l=e.availableNearestNeighbors,s=e.availableClusters,u=e.availableProperties,d=e.availableOpacityProperties,b=e.availableConnectByProperties,j=o.useState(Fe()()),m=Object(c.a)(j,2),f=m[0];m[1];return Object(I.jsxs)("form",{className:"row",children:[i?Object(I.jsx)(Re,{multi:!1,inline:t,id:"projection".concat(f,"Select"),label:"Projection",option:n.projection,options:i,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{projection:e}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u}):null,Object(I.jsx)(Re,{multi:!1,inline:t,id:"colorEncoding".concat(f,"Select"),label:"Color Encoding",option:n.plotOptions.colorBy,options:u,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{colorBy:e})}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u,extensions:[Ue,We,ze,Ve]}),Object(I.jsx)(Re,{multi:!1,inline:t,id:"opacity".concat(f,"Select"),label:"Opacity By",option:"number"===typeof n.plotOptions.opacityBy?"constant":n.plotOptions.opacityBy,options:d,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{opacityBy:"constant"===e?.5:e})}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u,extensions:[Ue,We,ze,Ve]}),"number"===typeof n.plotOptions.opacityBy?Object(I.jsx)("div",{className:"mb-3 me-sm-2",children:Object(I.jsx)("input",{type:"range",className:"form-range",min:0,max:1,step:.01,value:n.plotOptions.opacityBy,onChange:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{opacityBy:e.currentTarget.valueAsNumber})}))}})}):null,Object(I.jsx)(Re,{multi:!1,inline:t,id:"grouping".concat(f,"Select"),label:"Group By",option:n.plotOptions.groupBy,options:u,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{groupBy:e})}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u,extensions:[Ue,We,ze,Ve]}),Object(I.jsx)(Re,{multi:!1,inline:t,id:"sizeBy".concat(f,"Select"),label:"Size by",option:n.plotOptions.sizeBy,options:u,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{sizeBy:e})}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u,extensions:[Ue,We,Ve]}),Object(I.jsx)(Re,{inline:t,id:"connectBy".concat(f,"Select"),label:"Connect by",multi:!0,option:n.plotOptions.connectBy,options:b,setOption:function(e){r(Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions),{},{connectBy:0===e.length?null:e})}))},availableNearestNeighbors:l,availableClusters:s,availableProperties:u,extensions:[Ue,We,Ke,ze,Ve]})]})};function He(e){var t=e.config,n=e.availableProjections,r=e.availableNearestNeighbors,i=e.availableClusters,l=e.availableProperties,s=e.availableOpacityProperties,u=e.availableConnectByProperties,d=e.onHide,b=e.onSave,j=o.useState(t),m=Object(c.a)(j,2),O=m[0],h=m[1];return o.useEffect((function(){h(t)}),[t]),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(f.a,{show:Boolean(O),onHide:d,size:"lg",children:[Object(I.jsx)(f.a.Header,{closeButton:!0,children:Object(I.jsxs)(f.a.Title,{children:["Configure ",null===O||void 0===O?void 0:O.value]})}),Object(I.jsx)(f.a.Body,{children:O?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"d-flex position-relative",children:[Object(I.jsx)("label",{className:"my-1 me-2 col-sm-2 d-flex align-items-center",style:{whiteSpace:"nowrap"},htmlFor:"projectionNameInput",children:"Name"}),Object(I.jsx)("div",{className:"my-1 me-sm-2 flex-fill col-sm-10",children:Object(I.jsx)("input",{type:"text",id:"projectionNameInput",className:"form-control",value:O.label,onChange:function(e){return h(Object(a.a)(Object(a.a)({},O),{},{value:e.currentTarget.value,label:e.currentTarget.value}))}})})]}),Object(I.jsx)(qe,{inline:!1,availableProjections:n,availableNearestNeighbors:r,availableClusters:i,availableConnectByProperties:u,availableProperties:l,availableOpacityProperties:s,setConfig:h,config:O})]}):null}),Object(I.jsxs)(f.a.Footer,{children:[Object(I.jsx)(p.a,{variant:"secondary",onClick:d,children:"Close"}),Object(I.jsx)(p.a,{variant:"primary",onClick:function(){return O?null===b||void 0===b?void 0:b(O):null},children:"Save"})]})]})})}var $e=n(231),Ge=n.n($e),Je=n(278),Ye=n(275);function Xe(e){var t=e.registry,n=e.collections,b=e.setCollections,j=e.interpolationStructures,m=e.setInterpolationStructures,f=e.setActiveTab,p=o.useMemo((function(){return n.reduce((function(e,t){return[].concat(Object(i.a)(e),Object(i.a)(t.data))}),[])}),[n]),O=o.useState(null),v=Object(c.a)(O,2),_=v[0],x=v[1],g=o.useState(!1),y=Object(c.a)(g,2),E=y[0],N=y[1],C=o.useState(!1),S=Object(c.a)(C,2),M=(S[0],S[1],o.useState(!1)),P=Object(c.a)(M,2),k=P[0],T=P[1],D=o.useState([{label:"ecfp4_umap",value:"ecfp4_umap",projection:"ecfp4_umap",plotOptions:{}}]),A=Object(c.a)(D,2),B=A[0],R=A[1],L=o.useState(void 0),F=Object(c.a)(L,2),U=F[0],W=F[1],K=o.useState(null),z=Object(c.a)(K,2),q=z[0],H=z[1],Y=o.useState(null),X=Object(c.a)(Y,2),Q=X[0],Z=X[1],ee=o.useState(null),te=Object(c.a)(ee,2),ne=te[0],re=te[1],ae=o.useCallback((function(e){if(n.forEach((function(e){return e.data.forEach((function(e){return e.selected=!1}))})),e){var t=function(e){return e.selected=!0};Array.isArray(e)?e.forEach(t):Object.values(e).forEach((function(e){return e.forEach(t)}))}re(e)}),[n]),ie=o.useState({colorBy:null,opacityBy:null,groupBy:null,connectBy:null,sizeBy:null}),oe=Object(c.a)(ie,2),le=oe[0],ue=oe[1],be=o.useState(null),je=Object(c.a)(be,2),me=je[0],fe=je[1],pe=o.useState(null),he=Object(c.a)(pe,2),ve=he[0],_e=he[1],xe=o.useState(void 0),ye=Object(c.a)(xe,2),Ee=ye[0],Ne=ye[1],Ce=o.useState(!1),Se=Object(c.a)(Ce,2),we=Se[0],Ae=Se[1],Be=o.useMemo((function(){return["properties","projection","embedding","nearest_neighbors","clusters"].map((function(e){return Array.from(p.reduce((function(t,n){return Object.keys(n[e]||{}).forEach((function(e){return t.add(e)})),t}),new Set).keys())}))}),[p]),Re=Object(c.a)(Be,5),Le=Re[0],Fe=Re[1],Ue=Re[2],We=Re[3],Ke=Re[4],ze=o.useMemo((function(){return[].concat(Object(i.a)(Le),["constant"])}),[Le]),Ve=o.useMemo((function(){return Le}),[Le]);o.useEffect((function(){le.colorBy&&Le.includes(le.colorBy),le.opacityBy&&"number"!==typeof le.opacityBy&&!ze.includes(le.opacityBy)&&ue(Object(a.a)(Object(a.a)({},le),{},{opacityBy:null})),le.groupBy&&!Le.includes(le.groupBy)&&ue(Object(a.a)(Object(a.a)({},le),{},{groupBy:null})),le.connectBy&&le.connectBy.some((function(e){return!Ve.includes(e)})),le.sizeBy&&!Le.includes(le.sizeBy)&&ue(Object(a.a)(Object(a.a)({},le),{},{sizeBy:null}))}),[Le,ze,Ve,le]),o.useEffect((function(){0}),[]);var $e=o.useMemo((function(){return Q?Object.entries(Q).map((function(e){var t=Object(c.a)(e,2);return{name:t[0],data:t[1]}})):n}),[Q,n]),Xe=o.useMemo((function(){return we&&ne?Object.entries(ne).map((function(e){var t=Object(c.a)(e,2);return{name:t[0],data:t[1]}})):n}),[n,we,ne]),Qe=o.useMemo((function(){return Ue.reduce((function(e,t){return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},t,$e.map((function(e){var n=e.data.slice(0,10).filter((function(e){var n;return null===(n=e.embedding)||void 0===n?void 0:n[t]})).map((function(e){return e.embedding[t].map((function(t,n){return Object(a.a)(Object(a.a)({},e),{},{properties:Object(a.a)(Object(a.a)({},e.properties||{}),{},{latentX:n,latentY:t})})}))})).flat();return Object(a.a)(Object(a.a)({},e),{},{data:n})}))))}),{})}),[$e,Ue]);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(w.a,{children:q?Object(I.jsx)(h.a,{structure:q.structure,style:{width:180,backgroundColor:"rgba(255, 255, 255, 0.6)"}}):null}),Object(I.jsx)(He,{config:U,availableNearestNeighbors:We,availableClusters:Ke,availableProjections:Fe,availableProperties:Le,availableOpacityProperties:ze,availableConnectByProperties:Ve,onHide:function(){return W(void 0)},onSave:function(e){W(void 0),B.includes(U)?R((function(t){return t.map((function(t){return t===U?e:t}))})):Ee&&Ee!==U||Ne(e)}}),Object(I.jsxs)(d.a,{label:"Options",position:"left",size:"col-3",collapsed:k,setCollapsed:T,children:[Object(I.jsx)($,{addCollection:function(e){return b([].concat(Object(i.a)(n),[e]))},loading:E,setLoading:N}),Object(I.jsx)(V,{availableObjectives:null===t||void 0===t?void 0:t.objectives,addCollection:function(e){return b([].concat(Object(i.a)(n),[e]))},selection:ne,loading:E,setLoading:N}),Object(I.jsx)(Pe.a,{open:!1,setCollection:function(e){b([].concat(Object(i.a)(n.filter((function(t){return t.name!==e.name}))),[e]))},loading:E,setLoading:N,setStructures:m,structures:j}),Object(I.jsx)(ke,{addCollection:function(e){return b([].concat(Object(i.a)(n),[e]))},loading:E,setLoading:N,selection:ne}),Object(I.jsx)(G,{collections:n,setCollections:b,selection:ne,loading:E,setLoading:N}),Object(I.jsx)(J,{collections:n,setCollections:b,selection:ne,loading:E,setLoading:N}),Object(I.jsx)(Ie,{visible:_,setVisible:x,collections:n,setCollections:b,selection:ne,loading:E,setLoading:N}),Object(I.jsx)(Te,{collections:n,setCollections:b,selection:ne,loading:E,setLoading:N}),Object(I.jsx)(De,{addCollection:function(e){return b([].concat(Object(i.a)(n),[e]))},selection:ne,loading:E,setLoading:N})]}),Object(I.jsxs)(Je.a,{gutterSize:5,sizes:[75,25],className:"split col-".concat(k?"12":"9"),style:{height:"100%",paddingLeft:k?40:0},onDragEnd:function(){window.dispatchEvent(new Event("resize"))},children:[Object(I.jsx)("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto",paddingRight:15},children:Object(I.jsx)(l.a,{loading:E&&0===n.length,fallback:"Please select structures for embedding",loadingText:"Computing embedding of structures...",children:n.length>0?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("h6",{className:"d-inline-block",children:["Plot Options ",Object(I.jsx)("small",{className:"text-muted",children:"to customize the projection plots"})]})}),Object(I.jsx)("div",{className:"ms-3",children:[{name:"General",plotOptions:le,setter:function(e){return ue(Object(a.a)(Object(a.a)({},le),e))}}].concat(Object(i.a)(n.map((function(e){return{name:e.name,plotOptions:e.plotOptions||{},setter:function(t){return b(n.map((function(n){return n===e?Object(a.a)(Object(a.a)({},n),{},{plotOptions:Object(a.a)(Object(a.a)({},n.plotOptions||{}),t)}):n})))}}})))).map((function(e,t){var n=e.name,r=e.setter,a=e.plotOptions;return Object(I.jsxs)("details",{open:0===t,children:[Object(I.jsxs)("summary",{children:[n," Options"," ",Object(I.jsx)("small",{className:"text-muted",children:Object.values(a).filter(Boolean).length})]}),Object(I.jsx)(qe,{inline:!0,availableNearestNeighbors:We,availableClusters:Ke,availableConnectByProperties:Ve,availableProperties:Le,availableOpacityProperties:ze,setConfig:function(e){return r(e.plotOptions)},config:{label:"General",value:"",projection:"",plotOptions:a}})]})}))})]}),Object(I.jsxs)("details",{className:"row",style:{position:"relative"},open:!0,children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("h6",{className:"d-inline-block",children:["Parallel Coordinates ",Object(I.jsx)("small",{className:"text-muted",children:"to compare multiple numeric properties"})]})}),Object(I.jsx)(de,{collections:$e,selection:ne,setSelection:ae})]}),Object(I.jsxs)("details",{className:"row",style:{position:"relative"},open:!0,children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("h6",{className:"d-inline-block",children:["Custom Plot ",Object(I.jsx)("small",{className:"text-muted",children:"to compare two arbitrary properties"})]})}),Object(I.jsx)(se,{children:Object(I.jsx)(ce,{gridOptions:{w:12,h:25,y:0,x:0},onSettings:function(){return W(Ee||{label:"Custom",value:"Custom",projection:null,plotOptions:{}})},children:Object(I.jsxs)(Me,{title:me&&ve?"".concat(me," vs. ").concat(ve):"Please select two axis properties",collections:$e,options:Object(a.a)(Object(a.a)({},le),Ge()((null===Ee||void 0===Ee?void 0:Ee.plotOptions)||{},(function(e){return e}))),hover:q,setHover:H,selected:ne,setSelected:ae,xAccessor:"properties.".concat(me),yAccessor:"properties.".concat(ve),children:[Object(I.jsx)("div",{style:{width:150,position:"absolute",left:-45,top:"50%",transform:"rotate(-90deg)"},children:Object(I.jsxs)("select",{className:"form-control form-control-sm",value:ve||"",onChange:function(e){return _e(e.currentTarget.value||null)},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),Le.map((function(e){return Object(I.jsx)("option",{children:e},e)}))]})}),Object(I.jsx)("div",{style:{width:150,position:"absolute",left:"40%",bottom:0},children:Object(I.jsxs)("select",{className:"form-control form-control-sm",value:me||"",onChange:function(e){return fe(e.currentTarget.value||null)},children:[Object(I.jsx)("option",{value:"",children:"Select..."}),Le.map((function(e){return Object(I.jsx)("option",{children:e},e)}))]})})]})},"Custom")})]}),Object(I.jsxs)("details",{className:"row",style:{position:"relative"},open:!0,children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("h6",{className:"d-inline-block",children:["Latent Space Visualization ",Object(I.jsx)("small",{className:"text-muted"})]})}),Object(I.jsx)(se,{children:Object.keys(Qe||[]).map((function(e){return Object(I.jsx)(ce,{gridOptions:{w:12,h:25,y:0,x:0},children:Object(I.jsx)(Me,{title:"Top ".concat(10," in ").concat(e.toUpperCase()," Latent Space"),collections:Qe[e],options:le,hover:q,setHover:function(e){var t;H(e&&(null===(t=n.find((function(t){return t.name===e.collection})))||void 0===t?void 0:t.data.find((function(t){return t.index===e.index})))||null)},selected:ne,setSelected:function(e){ae(e)},xAccessor:"properties[latentX]",yAccessor:"properties[latentY]"})},e)}))})]}),Object(I.jsxs)("details",{open:!0,children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("h6",{className:"d-inline-block",children:["Projections"," ",Object(I.jsxs)("small",{className:"text-muted",children:[B.length," out of ",Fe.length]})]})}),Object(I.jsx)(Oe.a,{isMulti:!0,name:"projections",value:B,onChange:function(e){R(e.map((function(e){return e})))},onCreateOption:function(e){var t={label:e,value:e,projection:"",plotOptions:{}};R([].concat(Object(i.a)(B),[t])),W(t)},options:Fe.map((function(e){return{label:e,value:e,projection:e,plotOptions:{}}})),closeMenuOnSelect:!1}),Object(I.jsx)("div",{className:"row",style:{position:"relative"},children:Object(I.jsx)(se,{children:B.map((function(e,t){return Object(I.jsx)(ce,{onClose:function(){R(B.filter((function(t){return t!==e})))},onSettings:function(){return W(e)},gridOptions:{w:6,h:25,y:0+25*Math.floor(t/2),x:t%2===0?0:6},renderInfo:function(){return Object(I.jsx)(I.Fragment,{children:$e.map((function(t){var n;return Object(I.jsxs)("div",{className:"d-flex flex-column",children:[Object(I.jsx)("strong",{className:"text-nowrap text-truncate",children:t.name}),Object.entries((null===(n=t.projections)||void 0===n?void 0:n[e.projection])||{}).filter((function(e){var t=Object(c.a)(e,2);t[0];return"number"===typeof t[1]})).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(I.jsxs)("div",{className:"text-nowrap d-flex",children:[Object(I.jsx)("span",{className:"text-truncate",children:n}),Object(I.jsxs)("span",{className:"flex-fill",children:[": ",r.toFixed(3)||"Not available"]})]})}))]})}))})},children:Object(I.jsx)(Me,{title:e.value,collections:$e,options:Object(a.a)(Object(a.a)({},le),Ge()(e.plotOptions,(function(e){return e}))),hover:q,setHover:H,selected:ne,setSelected:ae,xAccessor:"projection[".concat(e.projection,"][0]"),yAccessor:"projection[".concat(e.projection,"][1]")})},e.value)}))})})]}),Object(I.jsx)(u.a,{collections:Xe,selected:ne,setSelected:ae,setFiltered:Z,tableClass:"main-ranking",structureCardProps:function(e){return{className:e===q?"border-primary":e.selected?"border-secondary":""}},renderTopForm:Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"form-check form-switch me-sm-2",children:[Object(I.jsx)("input",{type:"checkbox",className:"form-check-input",id:"customSwitch1",checked:we,onChange:function(e){return Ae(e.currentTarget.checked)}}),Object(I.jsx)("label",{className:"form-check-label",htmlFor:"customSwitch1",children:"Show selected only"})]}),Object(I.jsx)("button",{className:"btn btn-sm btn-primary",disabled:!ne,onClick:function(){m(Object.values(ne).flat().map((function(e){return e.structure}))),f(s.b.INTERPOLATION)},children:"Use for interpolation"})]})})]}):null})}),Object(I.jsx)("div",{children:Object(I.jsx)(Ye.a,{handleWidth:!0,children:function(e){var t=e.width;e.height;return Object(I.jsx)("div",{style:{height:"100%",overflow:"auto",paddingRight:15},children:t>200?Object(I.jsx)(ge,{collections:n,setCollections:b,selection:ne,setSelection:ae,setVisibleNeighborhoodSamplings:x,hover:q,setHover:H}):Object(I.jsx)("span",{style:{transform:"rotate(90deg)",position:"absolute",top:"50%",whiteSpace:"nowrap"},children:"Additional Options"})})}})})]})]})}},300:function(e,t,n){},328:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(46),i=n.n(c),o=(n(295),n(296),n(297),n(298),n(299),n(300),n(261)),l=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,383)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},s=n(0);i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(o.a,{})}),document.getElementById("root")),l()},34:function(e,t,n){"use strict";n.d(t,"l",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"k",(function(){return b})),n.d(t,"c",(function(){return j})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return O})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return _})),n.d(t,"g",(function(){return x}));var r=n(26),a=n.n(r),c=n(37),i=n(54);function o(e){var t=e.url,n=e.data,r=e.method;return fetch(t,{headers:{"Content-Type":"application/json"},method:void 0===r?"POST":r,redirect:"follow",body:Object(i.e)(n)}).then(function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=18;break}return e.t0=Error,e.next=4,t.json().catch((function(){return null}));case 4:if(e.t3=n=e.sent,e.t2=null===e.t3,e.t2){e.next=8;break}e.t2=void 0===n;case 8:if(!e.t2){e.next=12;break}e.t4=void 0,e.next=13;break;case 12:e.t4=n.message;case 13:if(e.t1=e.t4,e.t1){e.next=16;break}e.t1=t.statusText;case 16:throw e.t5=e.t1,(0,e.t0)(e.t5);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function l(e,t){return o({url:e,data:t}).then((function(e){return e.json()}))}function s(e,t){return o({url:e,data:t}).then((function(e){return e.text()}))}function u(e){return l("/api/pso/",e)}function d(e){return l("/api/embedding/",e)}function b(e,t){return l("/api/interpolation/",{structures:e,maxSamples:t})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"/api/image/?structure=".concat(encodeURIComponent(e)).concat(t?"&substructure=".concat(encodeURIComponent(t)):"").concat(n?"&align=".concat(encodeURIComponent(n)):"")}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";return s("/api/image/",{structures:e,method:t}).catch((function(){return null}))}function f(e,t){return l("/api/projection/models",{particles:e.map((function(e){return{structure:e.structure,embedding:e.embedding}})),models:t})}function p(e,t){return l("/api/mol/substructures/",{structures:e,smarts:t})}function O(e,t,n){return l("/api/mol/tanimoto/",{structures:e,reference:t,fingerprint:n})}function h(e,t,n,r){return l("/api/sampling/",{structure:e,samples:t,method:n,scale:r})}function v(e){return l("/api/mmp/",e)}function _(e){return l("/api/stoned_selfies/",e)}function x(){return o({url:"/api/registry/",method:"GET"}).then((function(e){return e.json()}))}},44:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(5),a=n(177),c=n.n(a),i=n(1),o=n(46),l=n(178),s=n(0);function u(e){var t=i.useRef(e);return t.current=e,t}var d=function(e){var t=e.children,n=e.anchor,a=void 0===n?"right":n,l=i.useState(null),s=Object(r.a)(l,2),u=s[0],d=s[1],b=function(e){var t=i.useState(null),n=Object(r.a)(t,2),a=n[0],o=n[1];return i.useEffect((function(){if(e){var t=c()((function(e){return o({x:e.clientX,y:e.clientY})}),5);return window.addEventListener("mousemove",t),function(){window.removeEventListener("mousemove",t)}}o(null)}),[e]),a}(Boolean(u&&t));return i.useEffect((function(){var e=document.createElement("div");return e.style.position="absolute",e.style.pointerEvents="none",e.style.transform="right"===a?"translate(10%, -50%)":"translate(-50%, 5%)",e.style.zIndex="10000",document.body.appendChild(e),d(e),function(){document.body.removeChild(e)}}),[a]),i.useEffect((function(){u&&(b?(u.style.left="".concat(b.x,"px"),u.style.top="".concat(b.y,"px"),u.style.display="block"):u.style.display="none")}),[u,b]),u&&t&&b?o.createPortal(t,u):null};function b(e,t){var n=i.useState(""),a=Object(r.a)(n,2),c=a[0],o=a[1],u=i.useRef(e),d=i.useContext(l.a),b=(c||t).replaceAll(/\[|\]|\./g,"_"),j=d.some((function(e){return e.name===b}));return[b,o,Object(s.jsxs)("div",{className:"mb-3",children:[Object(s.jsx)("label",{htmlFor:u.current,children:"Name"}),Object(s.jsx)("input",{type:"text",className:"form-control form-control-sm ".concat(j?"is-invalid":""),id:u.current,required:!!j||!t,pattern:j?"^$":void 0,value:c,placeholder:t,onChange:function(e){return o(e.currentTarget.value)}}),j?Object(s.jsx)("div",{className:"invalid-feedback",children:"Collection with this name already exists."}):null]})]}},53:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(26),a=n.n(r),c=n(37),i=n(5),o=n(1),l=n(370),s=n(0),u=function(e){var t=e.open,n=void 0!==t&&t,r=e.lead,a=void 0===r||r,c=e.title,i=e.children;return Object(s.jsxs)("details",{open:n,children:[Object(s.jsx)("summary",{className:"d-flex ".concat(a?"lead":""),style:{alignItems:"center"},children:c}),i]})},d=function(e){var t=e.open,n=void 0!==t&&t,r=e.title,d=(e.loading,e.setLoading),b=void 0===d?function(){return null}:d,j=e.onSubmit,m=e.children,f=o.useState(null),p=Object(i.a)(f,2),O=p[0],h=p[1];return Object(s.jsx)(u,{open:n,title:r,children:Object(s.jsxs)("form",{onSubmit:function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),!t.currentTarget.reportValidity()){e.next=15;break}return b(!0),e.prev=4,h(null),e.next=8,j();case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.error(e.t0),h(e.t0.toString());case 14:b(!1);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),children:[O?Object(s.jsx)(l.a,{variant:"danger",onClose:function(){return h(null)},dismissible:!0,children:Object(s.jsx)("p",{children:O})}):null,m]})})}},54:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return h}));var r=n(26),a=n.n(r),c=n(37),i=n(330),o=n(233);function l(e,t,n){if("number"===typeof e||!Array.isArray(e))return e;if(n||(n=Object(i.a)(e)),"number"!==typeof n[0]||"number"!==typeof n[1])return e;if(n[0]===n[1]&&n[0]>=t[0]&&n[0]<=t[1])return e;var r=Object(o.a)().domain(n).range(t);return e.map((function(e){return r(e)}))}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null==e)return t;if(!0===e)return 1;if(!1===e)return 0;var n=parseFloat(e.toString());return isNaN(n)?t:n}function u(e,t){return e.reduce((function(e,n){var r=t(n);return r&&((null==e[0]||null!=r[0]&&r[0]<e[0])&&(e[0]=r[0]),(null==e[1]||null!=r[1]&&r[1]>e[1])&&(e[1]=r[1])),e}),[void 0,void 0])}function d(e){return JSON.stringify(e,(function(e,t){return"knn_particles"===e?null:t}))}function b(e,t){return j.apply(this,arguments)}function j(){return(j=Object(c.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,URL.createObjectURL(t);case 2:r=e.sent,(c=document.createElement("a")).href=r,c.download=n,document.body.appendChild(c),c.click(),document.body.removeChild(c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return f.apply(this,arguments)}function f(){return(f=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d(t),b(new Blob([r],{type:"application/json"}),n+".json");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return O.apply(this,arguments)}function O(){return(O=Object(c.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(new Blob([t],{type:"text/csv"}),n+".csv");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.cache,c=void 0===a||a;Object.defineProperty(e,t,{get:function(){var r=n();return c&&(delete e[t],h(e,t,(function(){return r}),{cache:!1})),r},configurable:!0,enumerable:!0})}},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3),a=n(5),c=n(10),i=n(1),o=n(34),l=n(161),s=n(0),u=i.memo((function(e){var t=e.structure,n=e.align,u=e.image,d=Object(c.a)(e,["structure","align","image"]),b=i.useState(void 0),j=Object(a.a)(b,2),m=j[0],f=j[1];return i.useEffect((function(){u?f(Object(l.b)(u)):Array.isArray(t)?Object(o.f)(t).then((function(e){f(e?Object(l.b)(e):null)})):f(Object(o.c)(t,null,n))}),[t,u,n]),m?Object(s.jsx)("img",Object(r.a)({src:m,alt:"",title:"",loading:"lazy",onLoad:function(e){return e.currentTarget.style.visibility="visible"},onError:function(e){return e.currentTarget.style.visibility="hidden"}},d||{})):void 0===m?Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},(null===d||void 0===d?void 0:d.style)||{}),{},{display:"flex",justifyContent:"center"}),children:Object(s.jsx)("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"})}):null}))},62:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(28),a=["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],c={euclidean_difference:function(e,t){return Math.sqrt(t.reduce((function(t,n){return t+Math.pow(n-e,2)}),0))},mean:function(e,t){return t.reduce((function(e,t){return e+Math.abs(t)}),0)/t.length},mean_rel_diff:function(e,t){return t.reduce((function(e,t){return e+Math.abs(t)}),0)/t.length/e},mean_rel_diff_log10:function(e,t){return t.reduce((function(e,t){return e+Math.log10(Math.abs(t))}),0)/t.length/Math.log10(e)},max:function(e,t){return Math.max.apply(Math,Object(r.a)(t))},max_difference:function(e,t){return Math.abs(Math.abs(e)-Math.abs(Math.max.apply(Math,Object(r.a)(t))))},min:function(e,t){return Math.min.apply(Math,Object(r.a)(t))},min_difference:function(e,t){return Math.abs(Math.abs(e)-Math.abs(Math.min.apply(Math,Object(r.a)(t))))}},i=Symbol("isProxy"),o={colorscale:[["0","#D0EBFF"],["0.5","#49a7bd"],["1.0","#31347a"]],reversescale:!1}},79:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var r,a="Particles";!function(e){e[e.EMBEDDING=0]="EMBEDDING",e[e.INTERPOLATION=1]="INTERPOLATION"}(r||(r={}))}},[[328,1,2]]]);
//# sourceMappingURL=main.a5728a73.chunk.js.map